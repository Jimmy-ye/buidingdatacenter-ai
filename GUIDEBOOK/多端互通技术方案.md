# BDC-AI å¤šç«¯äº’é€šæŠ€æœ¯æ–¹æ¡ˆ

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

**åˆ›å»ºæ—¶é—´**ï¼š2026-01-20
**æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0.0
**é€‚ç”¨é˜¶æ®µ**ï¼šé˜¶æ®µ 1 MVP åç»­æ‰©å±•

### ç›®æ ‡

å®ç° BDC-AI å¹³å°çš„ PC ç«¯å’Œç§»åŠ¨ç«¯äº’è”äº’é€šï¼Œæä¾›ç»Ÿä¸€çš„å¯è§†åŒ– UI ç•Œé¢ï¼Œæ”¯æŒå¤šç«¯æ•°æ®åŒæ­¥å’Œç¦»çº¿æ“ä½œã€‚

---

## ğŸ¯ æ ¸å¿ƒéœ€æ±‚åˆ†æ

### åŠŸèƒ½éœ€æ±‚

1. **PC ç«¯åŠŸèƒ½**
   - å·¥ç¨‹ç»“æ„æ ‘æµè§ˆï¼ˆBuilding/Zone/System/Deviceï¼‰
   - Asset èµ„äº§ç®¡ç†ï¼ˆå›¾ç‰‡ã€è¡¨æ ¼ã€æ–‡æ¡£ï¼‰
   - OCR ç»“æœæŸ¥çœ‹å’Œç¼–è¾‘
   - GLM-4V åœºæ™¯é—®é¢˜æŠ¥å‘Šå±•ç¤º
   - æ•°æ®ç»Ÿè®¡å’Œå¯è§†åŒ–

2. **ç§»åŠ¨ç«¯åŠŸèƒ½**
   - ç°åœºæ‹ç…§ä¸Šä¼ 
   - è¯­éŸ³è®°å½•è½¬æ–‡å­—
   - äºŒç»´ç æ‰«æè®¾å¤‡è¯†åˆ«
   - ç¦»çº¿æ•°æ®é‡‡é›†
   - æ•°æ®åŒæ­¥

3. **å¤šç«¯ååŒ**
   - ç»Ÿä¸€çš„ç”¨æˆ·è®¤è¯
   - æ•°æ®å®æ—¶åŒæ­¥
   - ç¦»çº¿ç¼“å­˜æ”¯æŒ
   - å†²çªè§£å†³æœºåˆ¶

### éåŠŸèƒ½éœ€æ±‚

- **æ€§èƒ½**ï¼šé¡µé¢åŠ è½½ < 2 ç§’ï¼Œå›¾ç‰‡ä¸Šä¼  < 5 ç§’
- **å¯ç”¨æ€§**ï¼šæ”¯æŒç¦»çº¿æ“ä½œï¼Œç½‘ç»œæ¢å¤åè‡ªåŠ¨åŒæ­¥
- **å®‰å…¨æ€§**ï¼šAPI Token è®¤è¯ï¼Œæ•°æ®åŠ å¯†ä¼ è¾“
- **å…¼å®¹æ€§**ï¼šPC ç«¯æ”¯æŒä¸»æµæµè§ˆå™¨ï¼Œç§»åŠ¨ç«¯æ”¯æŒ iOS/Android

---

## ğŸ’» PC ç«¯æŠ€æœ¯æ–¹æ¡ˆ

### æ–¹æ¡ˆå¯¹æ¯”

| æŠ€æœ¯æ–¹æ¡ˆ | å¼€å‘è¯­è¨€ | å¼€å‘æ•ˆç‡ | UI ç¾è§‚åº¦ | é€‚ç”¨åœºæ™¯ | æ¨èæŒ‡æ•° |
|---------|---------|---------|----------|---------|----------|
| **NiceGUI** | Python | â­â­â­â­â­ | â­â­â­â­ | å†…éƒ¨å·¥å…·ã€å¿«é€ŸåŸå‹ | â­â­â­â­â­ |
| **Streamlit** | Python | â­â­â­â­â­ | â­â­â­ | æ•°æ®åˆ†æã€ä»ªè¡¨ç›˜ | â­â­â­â­ |
| **Dash** | Python | â­â­â­ | â­â­â­â­ | å¤æ‚äº¤äº’ã€å¯è§†åŒ– | â­â­â­ |
| **React + Ant Design** | JavaScript | â­â­ | â­â­â­â­â­ | ä¼ä¸šçº§åº”ç”¨ | â­â­â­â­ |
| **Vue3 + Element Plus** | JavaScript | â­â­â­ | â­â­â­â­â­ | ä¼ä¸šçº§åº”ç”¨ | â­â­â­â­ |

### æ¨èæ–¹æ¡ˆï¼šNiceGUIï¼ˆMVP é˜¶æ®µï¼‰

#### ä¼˜åŠ¿

- âœ… **çº¯ Python å¼€å‘**ï¼šæ— éœ€å­¦ä¹ å‰ç«¯æŠ€æœ¯
- âœ… **åŸºäº FastAPI**ï¼šä¸ç°æœ‰åç«¯æ— ç¼é›†æˆ
- âœ… **ç°ä»£åŒ– UI**ï¼šåŸºäº Vue.jsï¼Œç•Œé¢ç¾è§‚
- âœ… **å¿«é€Ÿå¼€å‘**ï¼š1-2 å¤©å¯å®ŒæˆåŸºç¡€ç•Œé¢
- âœ… **ç»„ä»¶ä¸°å¯Œ**ï¼šæŒ‰é’®ã€è¡¨æ ¼ã€å¯¹è¯æ¡†ã€å¯¼èˆªæ ç­‰
- âœ… **å“åº”å¼å¸ƒå±€**ï¼šæ”¯æŒæ¡Œé¢å’Œå¹³æ¿

#### æŠ€æœ¯æ ˆ

```python
# requirements.txt æ·»åŠ 
nicegui==2.7.0
```

#### ç¤ºä¾‹ä»£ç 

```python
from nicegui import ui, app
from fastapi import FastAPI
import httpx

# é›†æˆç°æœ‰ FastAPI åç«¯
backend_api = "http://localhost:8000/api/v1"

@ui.page('/')
def main_page():
    """ä¸»é¡µé¢ï¼šå·¥ç¨‹ç»“æ„æ ‘ + Asset åˆ—è¡¨"""

    with ui.row().style('height: 100vh; width: 100vw'):
        # å·¦ä¾§ï¼šå·¥ç¨‹ç»“æ„æ ‘
        with ui.card().style('width: 300px; height: 100%'):
            ui.label('å·¥ç¨‹ç»“æ„').classes('text-h6')
            tree = ui.tree([
                {'id': 'project-1', 'icon': 'building', 'children': [
                    {'id': 'building-1', 'icon': 'domain', 'label': 'Aåº§åŠå…¬æ¥¼', 'children': [
                        {'id': 'zone-1', 'icon': 'meeting_room', 'label': '5FåŠå…¬åŒº'},
                        {'id': 'zone-2', 'icon': 'meeting_room', 'label': '4FåŠå…¬åŒº'},
                    ]},
                ]}
            ], on_select=lambda e: load_assets(e))

        # å³ä¾§ï¼šAsset åˆ—è¡¨
        with ui.column().style('flex-grow: 1'):
            ui.label('èµ„äº§åˆ—è¡¨').classes('text-h6')

            with ui.row():
                ui.button('ä¸Šä¼ å›¾ç‰‡', on_click=upload_image)
                ui.button('åˆ·æ–°', on_click=refresh_assets)

            asset_table = ui.table(
                columns=[
                    {'name': 'id', 'label': 'ID', 'field': 'id'},
                    {'name': 'type', 'label': 'ç±»å‹', 'field': 'modality'},
                    {'name': 'time', 'label': 'æ—¶é—´', 'field': 'capture_time'},
                    {'name': 'actions', 'label': 'æ“ä½œ', 'field': 'actions'}
                ],
                rows=[]
            )

def load_assets(event):
    """åŠ è½½é€‰ä¸­èŠ‚ç‚¹çš„èµ„äº§"""
    node_id = event.value
    # è°ƒç”¨åç«¯ API
    response = httpx.get(f"{backend_api}/assets/?device_id={node_id}")
    assets = response.json()
    # æ›´æ–°è¡¨æ ¼
    asset_table.props('rows', assets)

def upload_image():
    """ä¸Šä¼ å›¾ç‰‡å¯¹è¯æ¡†"""
    with ui.dialog() as dialog, ui.card():
        ui.label('ä¸Šä¼ å›¾ç‰‡').classes('text-h6')
        file_upload = ui.file_upload(accept='.jpg,.png')
        async def confirm():
            # è°ƒç”¨åç«¯ä¸Šä¼  API
            await upload_to_backend(file_upload.value)
            dialog.close()
        ui.button('ç¡®å®š', on_click=confirm)
        ui.button('å–æ¶ˆ', on_click=dialog.close)
    dialog.open()

# å¯åŠ¨æœåŠ¡
ui.run(
    title='BDC-AI å»ºç­‘èŠ‚èƒ½ç®¡ç†å¹³å°',
    port=8080,
    dark=True,
    reconnect_interval=5  # è‡ªåŠ¨é‡è¿
)
```

### å¤‡é€‰æ–¹æ¡ˆï¼šReact + Ant Designï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

#### é€‚ç”¨åœºæ™¯

- éœ€è¦é«˜åº¦å®šåˆ¶åŒ– UI
- å›¢é˜Ÿæœ‰å‰ç«¯å¼€å‘ç»éªŒ
- é•¿æœŸç»´æŠ¤çš„ä¼ä¸šçº§åº”ç”¨

#### æŠ€æœ¯æ ˆ

```json
{
  "dependencies": {
    "react": "^18.3.1",
    "antd": "^5.22.0",
    "axios": "^1.7.9",
    "react-router-dom": "^6.28.0",
    "@tanstack/react-query": "^5.62.7"
  }
}
```

#### æ ¸å¿ƒåŠŸèƒ½ç»„ä»¶

```jsx
// å·¥ç¨‹ç»“æ„æ ‘ç»„ä»¶
import { Tree } from 'antd';

const EngineeringTree = ({ onSelect }) => {
  const [treeData, setTreeData] = useState([]);

  useEffect(() => {
    // è°ƒç”¨ /api/v1/projects/{id}/structure_tree
    fetchTreeData();
  }, []);

  return (
    <Tree
      showIcon
      treeData={treeData}
      onSelect={onSelect}
    />
  );
};

// Asset åˆ—è¡¨ç»„ä»¶
import { Table, Upload, Button } from 'antd';

const AssetList = ({ nodeId }) => {
  const [assets, setAssets] = useState([]);

  useEffect(() => {
    // è°ƒç”¨ /api/v1/assets/?device_id={nodeId}
    fetchAssets(nodeId);
  }, [nodeId]);

  return (
    <>
      <Upload>
        <Button>ä¸Šä¼ å›¾ç‰‡</Button>
      </Upload>
      <Table dataSource={assets} columns={columns} />
    </>
  );
};
```

---

## ğŸ“± ç§»åŠ¨ç«¯æŠ€æœ¯æ–¹æ¡ˆ

### æ–¹æ¡ˆå¯¹æ¯”

| æŠ€æœ¯æ–¹æ¡ˆ | å¸‚åœºä»½é¢ | å¼€å‘è¯­è¨€ | æ€§èƒ½ | å­¦ä¹ æˆæœ¬ | ç”Ÿæ€ä¸°å¯Œåº¦ | æ¨èæŒ‡æ•° |
|---------|---------|---------|------|---------|-----------|----------|
| **Flutter** | 46% | Dart | â­â­â­â­â­ | â­â­â­ | â­â­â­â­ | â­â­â­â­â­ |
| **React Native** | 32% | JavaScript | â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ |
| **uni-app** | å›½å†…æµè¡Œ | Vue | â­â­â­ | â­â­â­â­ | â­â­â­ | â­â­â­ |

### æ¨èæ–¹æ¡ˆï¼šFlutterï¼ˆè·¨å¹³å°é¦–é€‰ï¼‰

#### ä¼˜åŠ¿

- âœ… **æ€§èƒ½ä¼˜å¼‚**ï¼šåŸç”Ÿæ¸²æŸ“ï¼Œ60fps æµç•…ä½“éªŒ
- âœ… **UI ä¸€è‡´æ€§**ï¼šiOS/Android å®Œå…¨ä¸€è‡´
- âœ… **ç”Ÿæ€ä¸°å¯Œ**ï¼š46% å¸‚åœºä»½é¢ï¼Œæ’ä»¶ä¼—å¤š
- âœ… **ç¦»çº¿æ”¯æŒ**ï¼šå†…ç½® SQLiteï¼Œæ”¯æŒç¦»çº¿å­˜å‚¨
- âœ… **çƒ­é‡è½½**ï¼šå¼€å‘æ•ˆç‡é«˜
- âœ… **Google æ”¯æŒ**ï¼šé•¿æœŸç»´æŠ¤ä¿è¯

#### æŠ€æœ¯æ ˆ

```yaml
# pubspec.yaml
dependencies:
  flutter:
    sdk: flutter
  http: ^1.2.2        # REST API è°ƒç”¨
  sqflite: ^2.4.1     # æœ¬åœ° SQLite
  path_provider: ^2.1.4  # æ–‡ä»¶è·¯å¾„
  image_picker: ^1.1.2    # ç›¸æœº/ç›¸å†Œ
  barcode_scan: ^0.0.1    # äºŒç»´ç æ‰«æ
  connectivity_plus: ^6.1.0  # ç½‘ç»œçŠ¶æ€
```

#### æ ¸å¿ƒåŠŸèƒ½å®ç°

**1. ç¦»çº¿æ•°æ®åŒæ­¥**

```dart
// æ•°æ®åŒæ­¥æœåŠ¡
class SyncService {
  final String baseUrl = 'http://your-server.com/api/v1';
  final Database db;

  // ä¸Šä¼ æœ¬åœ°å˜æ›´
  Future<void> uploadPendingChanges() async {
    final pending = await db.query('pending_changes');

    for (var change in pending) {
      try {
        final response = await http.post(
          Uri.parse('$baseUrl/assets/'),
          body: jsonEncode(change['data']),
        );

        if (response.statusCode == 201) {
          await db.delete('pending_changes', where: 'id = ?', whereArgs: [change['id']]);
        }
      } catch (e) {
        print('Sync failed: $e');
      }
    }
  }

  // ä¸‹è½½è¿œç¨‹æ•°æ®
  Future<void> downloadRemoteData() async {
    final response = await http.get(Uri.parse('$baseUrl/assets/'));

    if (response.statusCode == 200) {
      final assets = jsonDecode(response.body);
      for (var asset in assets) {
        await db.insert('assets', asset, conflictAlgorithm: ConflictAlgorithm.replace);
      }
    }
  }

  // ç›‘å¬ç½‘ç»œçŠ¶æ€
  void startSync() {
    Connectivity().onConnectivityChanged.listen((ConnectivityResult result) {
      if (result != ConnectivityResult.none) {
        uploadPendingChanges();
        downloadRemoteData();
      }
    });
  }
}
```

**2. å›¾ç‰‡ä¸Šä¼ **

```dart
// å›¾ç‰‡ä¸Šä¼ æœåŠ¡
class AssetService {
  final String baseUrl = 'http://your-server.com/api/v1';

  Future<String> uploadImage(File imageFile, Map<String, dynamic> metadata) async {
    var request = http.MultipartRequest(
      'POST',
      Uri.parse('$baseUrl/assets/upload_image_with_note'),
    );

    request.files.add(await http.MultipartFile.fromPath('file', imageFile.path));
    request.fields.addAll(metadata.map((k, v) => MapEntry(k, v.toString())));

    var response = await request.send();

    if (response.statusCode == 201) {
      var resp = await http.Response.fromStream(response);
      return jsonDecode(resp.body)['id'];
    } else {
      throw Exception('Upload failed');
    }
  }
}
```

**3. äºŒç»´ç æ‰«æè®¾å¤‡è¯†åˆ«**

```dart
import 'package:barcode_scan/barcode_scan.dart';

class DeviceScanner extends StatefulWidget {
  @override
  _DeviceScannerState createState() => _DeviceScannerState();
}

class _DeviceScannerState extends State<DeviceScanner> {
  Future<void> scanQRCode() async {
    try {
      String qrCode = await BarcodeScanner.scan();
      // è§£æ QR Code è·å–è®¾å¤‡ ID
      final deviceId = parseDeviceId(qrCode);
      // è·³è½¬åˆ°è®¾å¤‡è¯¦æƒ…é¡µ
      Navigator.push(
        context,
        MaterialPageRoute(builder: (context) => DeviceDetailPage(deviceId)),
      );
    } catch (e) {
      print('Scan failed: $e');
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('è®¾å¤‡æ‰«æ')),
      body: Center(
        child: ElevatedButton(
          onPressed: scanQRCode,
          child: Text('æ‰«æäºŒç»´ç '),
        ),
      ),
    );
  }
}
```

### å¤‡é€‰æ–¹æ¡ˆï¼šReact Nativeï¼ˆé€‚åˆæœ‰ React ç»éªŒçš„å›¢é˜Ÿï¼‰

#### æŠ€æœ¯æ ˆ

```json
{
  "dependencies": {
    "react": "^18.3.1",
    "react-native": "^0.76.1",
    "@react-navigation/native": "^6.1.18",
    "axios": "^1.7.9",
    "@react-native-async-storage/async-storage": "^2.1.0",
    "react-native-camera": "^4.2.1",
    "react-native-qrcode-scanner": "^1.5.5"
  }
}
```

#### ç¦»çº¿å­˜å‚¨æ–¹æ¡ˆ

```javascript
import AsyncStorage from '@react-native-async-storage/async-storage';

// æœ¬åœ°å­˜å‚¨æœåŠ¡
class LocalStorage {
  static async saveAsset(asset) {
    const existing = await AsyncStorage.getItem('assets');
    const assets = existing ? JSON.parse(existing) : [];
    assets.push(asset);
    await AsyncStorage.setItem('assets', JSON.stringify(assets));
  }

  static async getAssets() {
    const assets = await AsyncStorage.getItem('assets');
    return assets ? JSON.parse(assets) : [];
  }

  static async clearAssets() {
    await AsyncStorage.removeItem('assets');
  }
}
```

---

## ğŸ”„ å¤šç«¯æ•°æ®åŒæ­¥ç­–ç•¥

### æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®åŒæ­¥æ¶æ„                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  PC ç«¯   â”‚         â”‚ ç§»åŠ¨ç«¯   â”‚         â”‚ æœåŠ¡å™¨   â”‚    â”‚
â”‚  â”‚          â”‚         â”‚ (å¤šå°)   â”‚         â”‚ PostgreSQLâ”‚    â”‚
â”‚  â”‚          â”‚         â”‚          â”‚         â”‚           â”‚    â”‚
â”‚  â”‚  NiceGUI â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Flutter  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ FastAPI  â”‚    â”‚
â”‚  â”‚          â”‚  REST   â”‚          â”‚  REST   â”‚          â”‚    â”‚
â”‚  â”‚          â”‚  API    â”‚          â”‚  API    â”‚          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â”‚                               â”‚
â”‚                        SQLite                            â”‚
â”‚                      (ç¦»çº¿ç¼“å­˜)                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åŒæ­¥ç­–ç•¥

#### 1. åœ¨çº¿æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰

æ‰€æœ‰æ“ä½œç›´æ¥è°ƒç”¨ REST APIï¼š

```
PC ç«¯/ç§»åŠ¨ç«¯ â”€â”€HTTPâ”€â”€â–º FastAPI â”€â”€â–º PostgreSQL
                    â—„â”€â”€â”€ JSON â—„â”€â”€â”€
```

#### 2. ç¦»çº¿ä¼˜å…ˆæ¨¡å¼ï¼ˆç§»åŠ¨ç«¯ï¼‰

```
ç§»åŠ¨ç«¯æ“ä½œ â”€â”€â–º SQLiteï¼ˆæœ¬åœ°ï¼‰
                â”‚
                â–¼ ç½‘ç»œæ¢å¤
           REST API â”€â”€â–º æœåŠ¡å™¨
                â—„â”€â”€â”€ ç¡®è®¤ â—„â”€â”€â”€
```

#### 3. å†²çªè§£å†³ç­–ç•¥

**æ—¶é—´æˆ³ä¼˜å…ˆ**ï¼šæœåŠ¡å™¨æ—¶é—´æˆ³ä¼˜å…ˆ

```python
# åç«¯å†²çªæ£€æµ‹
def resolve_conflict(local_asset, server_asset):
    if local_asset['updated_at'] > server_asset['updated_at']:
        return local_asset  # æœ¬åœ°æ›´æ–°
    else:
        return server_asset  # æœåŠ¡å™¨æ›´æ–°
```

**ç‰ˆæœ¬å‘é‡**ï¼šæ”¯æŒå¤šç«¯å¹¶å‘ç¼–è¾‘

```python
# Asset æ¨¡å‹æ·»åŠ ç‰ˆæœ¬å­—æ®µ
class Asset(Base):
    version = Column(Integer, default=1)  # ç‰ˆæœ¬å·
    updated_at = Column(DateTime, onupdate=datetime.utcnow)

# æ›´æ–°æ—¶é€’å¢ç‰ˆæœ¬
@router.put('/assets/{asset_id}')
async def update_asset(asset_id: uuid.UUID, asset_update: AssetUpdate):
    asset = db.query(Asset).filter(Asset.id == asset_id).first()
    if asset_update.version != asset.version:
        raise HTTPException(409, "Conflict: Asset was modified by another client")

    asset.version += 1
    # æ›´æ–°é€»è¾‘...
```

### æ•°æ®åŒæ­¥æµç¨‹

#### ä¸Šä¼ æµç¨‹

```python
# ç§»åŠ¨ç«¯ä¸Šä¼ é€»è¾‘
async def sync_pending_uploads():
    pending = await db.query('pending_uploads').all()

    for item in pending:
        try:
            # å°è¯•ä¸Šä¼ 
            response = await httpx.post(
                f"{API_BASE}/assets/upload_image_with_note",
                files={'file': item['file_path']},
                data=item['metadata']
            )

            if response.status_code == 201:
                # æˆåŠŸååˆ é™¤æœ¬åœ°è®°å½•
                await db.execute('DELETE FROM pending_uploads WHERE id = ?', [item['id']])
        except Exception as e:
            # å¤±è´¥ä¿ç•™è®°å½•ï¼Œä¸‹æ¬¡é‡è¯•
            print(f"Upload failed: {e}")
```

#### ä¸‹è½½æµç¨‹

```python
# ç§»åŠ¨ç«¯ä¸‹è½½é€»è¾‘
async def sync_remote_data():
    last_sync = await get_last_sync_time()

    # åªä¸‹è½½å¢é‡æ•°æ®
    response = await httpx.get(
        f"{API_BASE}/assets/",
        params={'updated_after': last_sync}
    )

    if response.status_code == 200:
        assets = response.json()
        for asset in assets:
            await db.insert_or_replace('assets', asset)

        await update_last_sync_time(datetime.utcnow())
```

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å®¢æˆ·ç«¯å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      PC ç«¯ï¼ˆNiceGUIï¼‰      â”‚      ç§»åŠ¨ç«¯ï¼ˆFlutterï¼‰           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  å·¥ç¨‹ç»“æ„æ ‘æµè§ˆ      â”‚  â”‚  â”‚  ç°åœºæ‹ç…§ä¸Šä¼            â”‚    â”‚
â”‚  â”‚  Asset åˆ—è¡¨å±•ç¤º      â”‚  â”‚  â”‚  äºŒç»´ç è®¾å¤‡æ‰«æ         â”‚    â”‚
â”‚  â”‚  OCR ç»“æœæŸ¥çœ‹        â”‚  â”‚  â”‚  è¯­éŸ³è®°å½•è½¬æ–‡å­—         â”‚    â”‚
â”‚  â”‚  æ•°æ®ç»Ÿè®¡å›¾è¡¨        â”‚  â”‚  â”‚  ç¦»çº¿æ•°æ®é‡‡é›†           â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚ HTTPS                    â”‚ HTTPS
            â”‚ REST API                â”‚ REST API
            â–¼                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FastAPI åç«¯æœåŠ¡                         â”‚
â”‚                   (http://localhost:8000)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Project      â”‚ Engineering  â”‚ Asset        â”‚ OCR/GLM         â”‚
â”‚ Service      â”‚ Service      â”‚ Service      â”‚ Worker          â”‚
â”‚              â”‚              â”‚              â”‚                 â”‚
â”‚ - é¡¹ç›®ç®¡ç†   â”‚ - ç»“æ„æ ‘     â”‚ - æ–‡ä»¶ä¸Šä¼    â”‚ - PaddleOCR     â”‚
â”‚ - æƒé™æ§åˆ¶   â”‚ - åå‘æŸ¥è¯¢   â”‚ - å¤šç»´è¿‡æ»¤   â”‚ - GLM-4V åˆ†æ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         æ•°æ®å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PostgreSQL   â”‚ æœ¬åœ°æ–‡ä»¶     â”‚ pgvector/TimescaleDB (é¢„ç•™)     â”‚
â”‚ 18.1         â”‚ å­˜å‚¨         â”‚                                 â”‚
â”‚              â”‚              â”‚                                 â”‚
â”‚ - UUID       â”‚ - Asset      â”‚ - å‘é‡æ£€ç´¢                      â”‚
â”‚ - JSONB      â”‚   åŸå§‹æ–‡ä»¶   â”‚ - æ—¶åºæ•°æ®                      â”‚
â”‚              â”‚              â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### API è®¾è®¡

#### ç»Ÿä¸€å“åº”æ ¼å¼

```python
# æ ‡å‡† API å“åº”
{
  "code": 200,
  "message": "success",
  "data": {...},
  "timestamp": "2026-01-20T10:30:00Z"
}

# é”™è¯¯å“åº”
{
  "code": 400,
  "message": "Invalid parameter",
  "errors": [...],
  "timestamp": "2026-01-20T10:30:00Z"
}
```

#### å…³é”®æ¥å£æ¸…å•

**å·¥ç¨‹ç»“æ„ç›¸å…³**ï¼š
- `GET /api/v1/projects/{id}/structure_tree` - è·å–å·¥ç¨‹ç»“æ„æ ‘
- `GET /api/v1/projects/{id}/devices/flat` - æ‰å¹³åŒ–è®¾å¤‡æŸ¥è¯¢
- `GET /api/v1/devices/{id}/assets` - åå‘æŸ¥è¯¢è®¾å¤‡èµ„äº§

**Asset ç›¸å…³**ï¼š
- `POST /api/v1/assets/upload_image_with_note` - ä¸Šä¼ å›¾ç‰‡
- `GET /api/v1/assets/?device_id={id}` - æŸ¥è¯¢èµ„äº§åˆ—è¡¨
- `GET /api/v1/assets/{id}` - è·å–èµ„äº§è¯¦æƒ…

**åŒæ­¥ç›¸å…³**ï¼ˆæ–°å¢ï¼‰ï¼š
- `POST /api/v1/sync/pull` - æ‹‰å–å¢é‡æ•°æ®
- `POST /api/v1/sync/push` - æ¨é€æœ¬åœ°å˜æ›´
- `GET /api/v1/sync/status` - æŸ¥è¯¢åŒæ­¥çŠ¶æ€

---

## ğŸ“… å®æ–½è®¡åˆ’

### é˜¶æ®µ 1ï¼šPC ç«¯åŸºç¡€ç•Œé¢ï¼ˆ1-2 å¤©ï¼‰

**ç›®æ ‡**ï¼šä½¿ç”¨ NiceGUI å¿«é€Ÿæ­å»ºå¯ç”¨ç•Œé¢

- [ ] å®‰è£… NiceGUI
- [ ] å®ç°å·¥ç¨‹ç»“æ„æ ‘å±•ç¤º
- [ ] å®ç° Asset åˆ—è¡¨å±•ç¤º
- [ ] å®ç°å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½
- [ ] å®ç° OCR ç»“æœæŸ¥çœ‹
- [ ] æµ‹è¯•ä¸ä¼˜åŒ–

### é˜¶æ®µ 2ï¼šç§»åŠ¨ç«¯åŸºç¡€åŠŸèƒ½ï¼ˆ3-5 å¤©ï¼‰

**ç›®æ ‡**ï¼šä½¿ç”¨ Flutter å®ç°æ ¸å¿ƒåŠŸèƒ½

- [ ] Flutter é¡¹ç›®åˆå§‹åŒ–
- [ ] å®ç°ç”¨æˆ·ç™»å½•
- [ ] å®ç°å·¥ç¨‹ç»“æ„æµè§ˆ
- [ ] å®ç°æ‹ç…§ä¸Šä¼ 
- [ ] å®ç°ç¦»çº¿å­˜å‚¨ï¼ˆSQLiteï¼‰
- [ ] å®ç°æ•°æ®åŒæ­¥é€»è¾‘
- [ ] å®ç°äºŒç»´ç æ‰«æ
- [ ] æµ‹è¯•ä¸ä¼˜åŒ–

### é˜¶æ®µ 3ï¼šå¤šç«¯æ•°æ®åŒæ­¥ï¼ˆ2-3 å¤©ï¼‰

**ç›®æ ‡**ï¼šå®ç°å¯é çš„æ•°æ®åŒæ­¥æœºåˆ¶

- [ ] è®¾è®¡åŒæ­¥ API æ¥å£
- [ ] å®ç°å†²çªè§£å†³ç­–ç•¥
- [ ] å®ç°ç¦»çº¿ç¼“å­˜æœºåˆ¶
- [ ] å®ç°å¢é‡åŒæ­¥
- [ ] æµ‹è¯•ä¸ä¼˜åŒ–

### é˜¶æ®µ 4ï¼šæµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆ2-3 å¤©ï¼‰

**ç›®æ ‡**ï¼šç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§å’Œç”¨æˆ·ä½“éªŒ

- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] ç¦»çº¿åœºæ™¯æµ‹è¯•
- [ ] å¤šç«¯å¹¶å‘æµ‹è¯•
- [ ] UI/UX ä¼˜åŒ–

**æ€»è®¡**ï¼š8-13 å¤©

---

## ğŸ“Š å¼€æºåº“æ¨è

### PC ç«¯

| åº“å | ç‰ˆæœ¬ | ç”¨é€” | è®¸å¯è¯ |
|------|------|------|--------|
| NiceGUI | 2.7.0 | å¿«é€Ÿ UI å¼€å‘ | MIT |
| Streamlit | 1.39.0 | æ•°æ®å¯è§†åŒ– | Apache 2.0 |
| Dash | 2.18.1 | äº¤äº’å¼ä»ªè¡¨ç›˜ | MIT |
| Ant Design | 5.22.0 | React UI ç»„ä»¶åº“ | MIT |

### ç§»åŠ¨ç«¯

| åº“å | ç‰ˆæœ¬ | ç”¨é€” | è®¸å¯è¯ |
|------|------|------|--------|
| Flutter | 3.27.1 | è·¨å¹³å°æ¡†æ¶ | BSD |
| http | 1.2.2 | REST API è°ƒç”¨ | BSD |
| sqflite | 2.4.1 | æœ¬åœ°æ•°æ®åº“ | BSD |
| image_picker | 1.1.2 | ç›¸æœº/ç›¸å†Œ | BSD |
| connectivity_plus | 6.1.0 | ç½‘ç»œçŠ¶æ€ | BSD |
| barcode_scan | 0.0.1 | äºŒç»´ç æ‰«æ | BSD |

### æ•°æ®åŒæ­¥

| åº“å | ç‰ˆæœ¬ | ç”¨é€” | è®¸å¯è¯ |
|------|------|------|--------|
| axios | 1.7.9 | HTTP å®¢æˆ·ç«¯ | MIT |
| AsyncStorage | 2.1.0 | æœ¬åœ°å­˜å‚¨ï¼ˆRNï¼‰ | MIT |
| rx_dart | 0.28.0 | å“åº”å¼ç¼–ç¨‹ | Apache 2.0 |

---

## ğŸ¯ æ¨èæŠ€æœ¯æ ˆ

### MVP é˜¶æ®µï¼ˆå¿«é€Ÿäº¤ä»˜ï¼‰

**PC ç«¯**ï¼šNiceGUI
- å¼€å‘é€Ÿåº¦å¿«ï¼ˆ1-2 å¤©ï¼‰
- çº¯ Pythonï¼Œæ— å‰ç«¯ä¾èµ–
- UI ç°ä»£åŒ–

**ç§»åŠ¨ç«¯**ï¼šFlutter
- æ€§èƒ½ä¼˜å¼‚
- è·¨å¹³å°æ”¯æŒ
- ç¦»çº¿èƒ½åŠ›å¼º

**æ•°æ®åŒæ­¥**ï¼šREST API + SQLite
- ç®€å•å¯é 
- æ˜“äºå®ç°

### ç”Ÿäº§é˜¶æ®µï¼ˆé•¿æœŸç»´æŠ¤ï¼‰

**PC ç«¯**ï¼šReact + Ant Design
- é«˜åº¦å®šåˆ¶åŒ–
- ç”Ÿæ€æˆç†Ÿ
- å›¢é˜Ÿç†Ÿæ‚‰

**ç§»åŠ¨ç«¯**ï¼šFlutter æˆ– React Native
- æ ¹æ®å›¢é˜ŸæŠ€æœ¯æ ˆé€‰æ‹©
- æ¨èæŒç»­ä½¿ç”¨ Flutter

**æ•°æ®åŒæ­¥**ï¼šWebSocket + å¢é‡åŒæ­¥
- å®æ—¶æ€§æ›´å¼º
- å‡å°‘å¸¦å®½å ç”¨

---

## ğŸ“– å‚è€ƒèµ„æ–™

### NiceGUI å®˜æ–¹æ–‡æ¡£
- https://nicegui.io/

### Flutter å®˜æ–¹æ–‡æ¡£
- https://flutter.dev/docs

### æ•°æ®åŒæ­¥æœ€ä½³å®è·µ
- https://sqlite.org/rowvalue.html
- https://www.postgresql.org/docs/current/ddl.html

### REST API è®¾è®¡æŒ‡å—
- https://restfulapi.net/

---

**æ–‡æ¡£ç»´æŠ¤**ï¼šæœ¬æ–‡æ¡£éšé¡¹ç›®è¿›å±•æŒç»­æ›´æ–°
**æœ€åæ›´æ–°**ï¼š2026-01-20
