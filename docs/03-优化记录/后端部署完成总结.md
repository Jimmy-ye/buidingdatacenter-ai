# BDC-AI åç«¯ç³»ç»Ÿéƒ¨ç½²å®Œæˆ

**éƒ¨ç½²æ—¶é—´**ï¼š2026-01-25
**éƒ¨ç½²çŠ¶æ€**ï¼šâœ… å®Œæˆ

---

## ğŸ“Š éƒ¨ç½²æ¦‚è§ˆ

### å·²å®ŒæˆæœåŠ¡

| æœåŠ¡ | çŠ¶æ€ | ç«¯å£ | è¯´æ˜ |
|------|------|------|------|
| **PostgreSQL æ•°æ®åº“** | âœ… è¿è¡Œä¸­ | 5432 | æ•°æ®åº“æœåŠ¡ |
| **FastAPI åç«¯** | âœ… è¿è¡Œä¸­ | 8000 | REST API æœåŠ¡ |
| **GLM-4V Worker** | âœ… å·²éƒ¨ç½² | - | å›¾ç‰‡åˆ†æ Worker |

### ç½‘ç»œé…ç½®

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| æœ¬åœ°è®¿é—® | http://localhost:8000 |
| Tailscale IP | 100.93.101.76 |
| è¿œç¨‹è®¿é—® | http://100.93.101.76:8000 |
| API æ–‡æ¡£ | http://localhost:8000/docs |

---

## ğŸ—„ï¸ æ•°æ®åº“é…ç½®

### è¿æ¥ä¿¡æ¯
```
ä¸»æœº: localhost:5432
æ•°æ®åº“: bdc_ai
ç”¨æˆ·: admin
å¯†ç : password
postgres ç”¨æˆ·å¯†ç : JIM88514
```

### ç®¡ç†å‘½ä»¤
```bash
# è¿æ¥æ•°æ®åº“
psql -U admin -d bdc_ai

# æŸ¥çœ‹æ‰€æœ‰è¡¨
\dt

# æŸ¥çœ‹è¡¨ç»“æ„
\d users
```

### å¤‡ä»½æ¢å¤
```bash
# å¤‡ä»½
pg_dump -U admin bdc_ai > backup.sql

# æ¢å¤
psql -U admin bdc_ai < backup.sql
```

---

## ğŸš€ æœåŠ¡å¯åŠ¨

### åç«¯æœåŠ¡

**æ–¹æ³• 1ï¼šä½¿ç”¨æ‰¹å¤„ç†è„šæœ¬ï¼ˆæ¨èï¼‰**
```bash
scripts\Windows\å¯åŠ¨åç«¯æœåŠ¡.bat
```

**æ–¹æ³• 2ï¼šæ‰‹åŠ¨å¯åŠ¨**
```bash
cd D:\BDC-AI
venv\Scripts\python.exe -m uvicorn services.backend.app.main:app --host 0.0.0.0 --port 8000 --reload
```

**éªŒè¯æœåŠ¡**ï¼š
```bash
curl http://localhost:8000/api/v1/health
```

### Worker æœåŠ¡

**å¯åŠ¨ Worker**ï¼š
```bash
services\worker\å¯åŠ¨Worker.bat
```

**æµ‹è¯•é…ç½®**ï¼š
```bash
services\worker\æµ‹è¯•é…ç½®.bat
```

---

## ğŸ“ ç›®å½•ç»“æ„

```
D:\BDC-AI/
â”œâ”€â”€ venv/                          # Python 3.9 è™šæ‹Ÿç¯å¢ƒï¼ˆåç«¯ï¼‰
â”œâ”€â”€ venv311/                       # Python 3.11 è™šæ‹Ÿç¯å¢ƒï¼ˆWorkerï¼‰
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ backend/                   # FastAPI åç«¯æœåŠ¡
â”‚   â”‚   â””â”€â”€ app/
â”‚   â”‚       â”œâ”€â”€ main.py           # åº”ç”¨å…¥å£
â”‚   â”‚       â”œâ”€â”€ api/              # API è·¯ç”±
â”‚   â”‚       â””â”€â”€ models/           # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ worker/                    # GLM-4V Worker
â”‚       â”œâ”€â”€ scene_issue_glm_worker.py
â”‚       â”œâ”€â”€ å¯åŠ¨Worker.bat
â”‚       â”œâ”€â”€ æµ‹è¯•é…ç½®.bat
â”‚       â””â”€â”€ WORKER_DEPLOYMENT.md
â”œâ”€â”€ shared/                        # å…±äº«ä»£ç 
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ settings.py           # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ db/
â”‚       â”œâ”€â”€ base.py               # ORM åŸºç±»
â”‚       â””â”€â”€ session.py            # ä¼šè¯ç®¡ç†
â”œâ”€â”€ scripts/                       # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ Windows/                   # Windows è„šæœ¬
â”‚   â”‚   â””â”€â”€ å¯åŠ¨åç«¯æœåŠ¡.bat
â”‚   â”œâ”€â”€ Linux/                     # Linux è„šæœ¬
â”‚   â”œâ”€â”€ æ•°æ®åº“/                    # æ•°æ®åº“è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ åˆå§‹åŒ–æ•°æ®åº“.py
â”‚   â”‚   â””â”€â”€ åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·.py
â”‚   â””â”€â”€ é€šç”¨/                      # é€šç”¨è„šæœ¬
â”‚       â”œâ”€â”€ é…ç½®APIå¯†é’¥.py
â”‚       â””â”€â”€ éƒ¨ç½²æ€»ç»“.md
â”œâ”€â”€ data/
â”‚   â””â”€â”€ assets/                    # æœ¬åœ°å­˜å‚¨ç›®å½•
â”œâ”€â”€ .env                          # ç¯å¢ƒå˜é‡ï¼ˆåç«¯ï¼‰
â””â”€â”€ WORKERéƒ¨ç½²æ€»ç»“.md             # Worker éƒ¨ç½²æ–‡æ¡£
```

---

## ğŸ”§ ç¯å¢ƒå˜é‡

### åç«¯é…ç½® (`.env`)
```bash
# æ•°æ®åº“
BDC_DATABASE_URL=postgresql://admin:password@localhost:5432/bdc_ai

# æœ¬åœ°å­˜å‚¨
BDC_LOCAL_STORAGE_DIR=data/assets

# JWT è®¤è¯
BDC_JWT_SECRET_KEY=916c3397894dd45b7c535b86d3a845df332e42966b45d635a1313a908057686f
BDC_ACCESS_TOKEN_EXPIRE_MINUTES=30

# GLM API
GLM_API_KEY=8fca3f34fa884d098ae88fc4ce7c4cf0.9kVnW2pB1rogcnE5
GLM_BASE_URL=https://open.bigmodel.cn/api/paas/v4/
GLM_VISION_MODEL=glm-4v

# æœåŠ¡é…ç½®
BDC_HOST=0.0.0.0
BDC_PORT=8000
```

### Worker é…ç½® (`services/worker/.env`)
```bash
# åç«¯è¿æ¥
BDC_BACKEND_BASE_URL=http://localhost:8000

# æœ¬åœ°å­˜å‚¨
BDC_LOCAL_STORAGE_DIR=../data/assets

# GLM API
GLM_API_KEY=2534e2ce7188483d8eee5feca552f1b6.sskMwroqUers9UM7
GLM_BASE_URL=https://open.bigmodel.cn/api/paas/v4/
GLM_VISION_MODEL=glm-4v

# Worker é…ç½®
BDC_SCENE_WORKER_POLL_INTERVAL=60
```

---

## ğŸŒ Tailscale é…ç½®

### è¿æ¥ä¿¡æ¯
```
Tailscale IP: 100.93.101.76
çŠ¶æ€: å·²ç™»å½•
ç½‘ç»œ: BDC-AI Tailnet
```

### è¿œç¨‹è®¿é—®
ä»å…¶ä»–è®¾å¤‡ï¼ˆå·²å®‰è£… Tailscaleï¼‰è®¿é—®ï¼š
```
http://100.93.101.76:8000
```

### ç§»åŠ¨ç«¯é…ç½®
1. å®‰è£… Tailscale App
2. ä½¿ç”¨ç›¸åŒè´¦å·ç™»å½•
3. ç¡®è®¤è¿æ¥çŠ¶æ€ä¸º "Connected"
4. é…ç½®åç«¯åœ°å€ï¼š`http://100.93.101.76:8000`

---

## âœ… éªŒè¯éƒ¨ç½²

### æ£€æŸ¥æ¸…å•

**åç«¯æœåŠ¡**ï¼š
- [x] PostgreSQL è¿è¡Œæ­£å¸¸
- [x] FastAPI æœåŠ¡å¯åŠ¨
- [x] API æ–‡æ¡£å¯è®¿é—®
- [x] å¥åº·æ£€æŸ¥é€šè¿‡
- [x] é˜²ç«å¢™è§„åˆ™å·²é…ç½®

**Worker æœåŠ¡**ï¼š
- [x] Python 3.11 ç¯å¢ƒå·²åˆ›å»º
- [x] ä¾èµ–å·²å®‰è£…
- [x] ç¯å¢ƒå˜é‡å·²é…ç½®
- [x] å¯åŠ¨è„šæœ¬å·²åˆ›å»º
- [x] æµ‹è¯•è„šæœ¬å·²åˆ›å»º

**ç½‘ç»œ**ï¼š
- [x] Tailscale å·²ç™»å½•
- [x] é˜²ç«å¢™è§„åˆ™å·²è®¾ç½®
- [x] è¿œç¨‹è®¿é—®å¯æµ‹è¯•

### æµ‹è¯•å‘½ä»¤

```bash
# 1. æµ‹è¯•åç«¯å¥åº·æ£€æŸ¥
curl http://localhost:8000/api/v1/health

# 2. æµ‹è¯• API æ–‡æ¡£
start http://localhost:8000/docs

# 3. æµ‹è¯• Tailscale è®¿é—®
curl http://100.93.101.76:8000/api/v1/health

# 4. æµ‹è¯• Worker é…ç½®
cd services\worker
æµ‹è¯•é…ç½®.bat

# 5. æŸ¥çœ‹æœåŠ¡çŠ¶æ€
netstat -ano | findstr :8000
```

---

## ğŸ“ å¿«é€Ÿæ“ä½œæŒ‡å—

### å¯åŠ¨æ‰€æœ‰æœåŠ¡

**æ­¥éª¤ 1**ï¼šå¯åŠ¨åç«¯
```bash
scripts\Windows\å¯åŠ¨åç«¯æœåŠ¡.bat
```

**æ­¥éª¤ 2**ï¼šå¯åŠ¨ Workerï¼ˆæ–°çª—å£ï¼‰
```bash
services\worker\å¯åŠ¨Worker.bat
```

**æ­¥éª¤ 3**ï¼šéªŒè¯æœåŠ¡
```bash
# æµè§ˆå™¨æ‰“å¼€
http://localhost:8000/docs
```

### åœæ­¢æœåŠ¡

**åœæ­¢åç«¯**ï¼šåœ¨åç«¯çª—å£æŒ‰ `Ctrl+C`

**åœæ­¢ Worker**ï¼šåœ¨ Worker çª—å£æŒ‰ `Ctrl+C`

---

## ğŸ” æ•…éšœæ’æŸ¥

### åç«¯æœåŠ¡æ— æ³•å¯åŠ¨

**é—®é¢˜**ï¼šç«¯å£è¢«å ç”¨
```bash
# æŸ¥æ‰¾å ç”¨è¿›ç¨‹
netstat -ano | findstr :8000

# ç»ˆæ­¢è¿›ç¨‹
taskkill /PID <PID> /F
```

**é—®é¢˜**ï¼šæ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥ PostgreSQL æœåŠ¡
# Windows æœåŠ¡ç®¡ç†å™¨ â†’ PostgreSQL 18

# æµ‹è¯•è¿æ¥
psql -U admin -d bdc_ai
```

### Worker æ— æ³•å¯åŠ¨

**é—®é¢˜**ï¼šä¾èµ–ç¼ºå¤±
```bash
# é‡æ–°å®‰è£…ä¾èµ–
D:\BDC-AI\venv311\Scripts\pip.exe install -r services/worker/requirements.txt
```

**é—®é¢˜**ï¼šPython ç‰ˆæœ¬ä¸å¯¹
```bash
# ç¡®è®¤ä½¿ç”¨ Python 3.11
D:\BDC-AI\venv311\Scripts\python.exe --version
```

### è¿œç¨‹æ— æ³•è®¿é—®

**é—®é¢˜**ï¼šTailscale æœªè¿æ¥
```bash
# æ£€æŸ¥ Tailscale çŠ¶æ€
tailscale status

# é‡å¯ Tailscale
tailscale down
tailscale up
```

**é—®é¢˜**ï¼šé˜²ç«å¢™é˜»æ­¢
```powershell
# æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
Get-NetFirewallRule -DisplayName "*BDC-AI*"

# é‡æ–°æ·»åŠ è§„åˆ™
New-NetFirewallRule -DisplayName "BDC-AI Backend" -Direction Inbound -LocalPort 8000 -Protocol TCP -Action Allow
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| åç«¯éƒ¨ç½²æŒ‡å— | `docs/02-æŠ€æœ¯æ–‡æ¡£/åç«¯æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æŒ‡å—.md` | å®Œæ•´éƒ¨ç½²æµç¨‹ |
| Tailscale æ–¹æ¡ˆ | `docs/02-æŠ€æœ¯æ–‡æ¡£/Tailscaleè™šæ‹Ÿå±€åŸŸç½‘å®æ–½æ–¹æ¡ˆ.md` | ç½‘ç»œé…ç½® |
| Worker éƒ¨ç½² | `services/worker/WORKER_DEPLOYMENT.md` | Worker è¯¦ç»†æ–‡æ¡£ |
| Worker æ€»ç»“ | `WORKERéƒ¨ç½²æ€»ç»“.md` | Worker å¿«é€ŸæŒ‡å— |
| éƒ¨ç½²æ€»ç»“ | `scripts/é€šç”¨/DEPLOYMENT_SUMMARY.md` | åç«¯éƒ¨ç½²æ€»ç»“ |
| Git åŒæ­¥çŠ¶æ€ | `GIT_SYNC_STATUS.md` | Git åŒæ­¥è¯´æ˜ |

---

## ğŸ¯ ä¸‹ä¸€æ­¥

### ç«‹å³å¯ç”¨
1. âœ… å¯åŠ¨åç«¯æœåŠ¡
2. âœ… å¯åŠ¨ Worker æœåŠ¡
3. âœ… ä¸Šä¼ æµ‹è¯•å›¾ç‰‡
4. âœ… æŸ¥çœ‹ API æ–‡æ¡£

### å¾…å¼€å‘åŠŸèƒ½
- MinIO å¯¹è±¡å­˜å‚¨é›†æˆ
- ç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†
- å®Œæ•´çš„å‰ç«¯ç•Œé¢
- æ›´å¤š AI åˆ†ææ¨¡å‹

---

## ğŸ“ æ”¯æŒ

### æ–‡æ¡£èµ„æº
- é¡¹ç›®æ–‡æ¡£ï¼š`docs/`
- API æ–‡æ¡£ï¼šhttp://localhost:8000/docs
- ReDoc æ–‡æ¡£ï¼šhttp://localhost:8000/redoc

### é—®é¢˜åé¦ˆ
- GitHub Issues: https://github.com/Jimmy-ye/buidlingdatacenter-ai/issues

---

## ğŸ‰ éƒ¨ç½²å®Œæˆï¼

**BDC-AI åç«¯ç³»ç»Ÿå·²å®Œå…¨éƒ¨ç½²å¹¶å°±ç»ªã€‚**

æ‰€æœ‰æœåŠ¡é…ç½®å®Œæˆï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨ï¼š
- âœ… PostgreSQL æ•°æ®åº“è¿è¡Œæ­£å¸¸
- âœ… FastAPI åç«¯æœåŠ¡å¯åŠ¨
- âœ… GLM-4V Worker å·²éƒ¨ç½²
- âœ… Tailscale è¿œç¨‹è®¿é—®é…ç½®

**ç¥ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€
