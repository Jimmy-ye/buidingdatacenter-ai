# ç§»åŠ¨ç«¯å®æ–½æ–¹æ¡ˆè§„åˆ’

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

- **åˆ›å»ºæ—¶é—´**ï¼š2026-01-23
- **æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0.0
- **é€‚ç”¨é˜¶æ®µ**ï¼šé˜¶æ®µ 2 - ç§»åŠ¨ç«¯å¼€å‘
- **æŠ€æœ¯é€‰å‹**ï¼šFlutter 3.27.1

---

## ğŸ¯ å®æ–½ç›®æ ‡

### æ ¸å¿ƒä»·å€¼

ç§»åŠ¨ç«¯ä½œä¸º**ç°åœºæ•°æ®é‡‡é›†ç»ˆç«¯**ï¼Œä¸ PC ç«¯å½¢æˆäº’è¡¥ï¼š

- **PC ç«¯**ï¼šé¡¹ç›®ç®¡ç†ã€æ•°æ®åˆ†æã€æŠ¥å‘Šè¾“å‡ºã€æ·±åº¦è¯Šæ–­
- **ç§»åŠ¨ç«¯**ï¼šç°åœºé‡‡é›†ã€å¿«é€Ÿå½•å…¥ã€è®¾å¤‡è¯†åˆ«ã€ç¦»çº¿æ“ä½œ

### ä¸»è¦åŠŸèƒ½

1. **ç°åœºæ•°æ®é‡‡é›†**
   - ğŸ“· æ‹ç…§ä¸Šä¼ ï¼ˆè®¾å¤‡é“­ç‰Œã€ç°åœºé—®é¢˜ã€ä»ªè¡¨è¯»æ•°ï¼‰
   - ğŸ¤ è¯­éŸ³è®°å½•è½¬æ–‡å­—ï¼ˆå·¥ç¨‹å¸ˆå¤‡æ³¨ã€é—®é¢˜æè¿°ï¼‰
   - ğŸ“ å¿«é€Ÿæ–‡å­—å½•å…¥
   - ğŸ“ GPS ä½ç½®è®°å½•

2. **å·¥ç¨‹ç»“æ„ç®¡ç†**
   - ğŸŒ² æµè§ˆå·¥ç¨‹ç»“æ„æ ‘ï¼ˆBuilding/Zone/System/Deviceï¼‰
   - ğŸ” äºŒç»´ç æ‰«æè®¾å¤‡è¯†åˆ«
   - ğŸ“‹ æŸ¥çœ‹è®¾å¤‡èµ„äº§åˆ—è¡¨
   - âœï¸ ç¼–è¾‘è®¾å¤‡ä¿¡æ¯

3. **ç¦»çº¿æ•°æ®åŒæ­¥**
   - ğŸ’¾ æœ¬åœ° SQLite ç¼“å­˜
   - ğŸ”„ è‡ªåŠ¨æ•°æ®åŒæ­¥
   - âš ï¸ å†²çªæ£€æµ‹ä¸è§£å†³
   - ğŸ“¶ ç½‘ç»œçŠ¶æ€ç›‘æ§

4. **ç”¨æˆ·è®¤è¯ä¸æƒé™**
   - ğŸ” ç”¨æˆ·ç™»å½•/ç™»å‡º
   - ğŸ“œ Token ç®¡ç†
   - ğŸš€ æƒé™æ§åˆ¶

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„è®¾è®¡

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Flutter ç§»åŠ¨ç«¯åº”ç”¨                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  UI Layer (Flutter)                   â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚
â”‚  â”‚  â”‚é¡¹ç›®åˆ—è¡¨  â”‚  â”‚å·¥ç¨‹ç»“æ„  â”‚  â”‚èµ„äº§é‡‡é›†  â”‚         â”‚   â”‚
â”‚  â”‚  â”‚  é¡µé¢    â”‚  â”‚  é¡µé¢    â”‚  â”‚  é¡µé¢    â”‚         â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Service Layer (ä¸šåŠ¡é€»è¾‘)                â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚ AuthService â”‚  â”‚AssetService  â”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚SyncService  â”‚  â”‚ApiService    â”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â†“                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              Data Layer (æ•°æ®å±‚)                      â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚   â”‚
â”‚  â”‚  â”‚ SQLite      â”‚  â”‚ HTTP Client  â”‚                â”‚   â”‚
â”‚  â”‚  â”‚ (æœ¬åœ°ç¼“å­˜)  â”‚  â”‚ (ç½‘ç»œè¯·æ±‚)    â”‚                â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“ HTTPS (REST API)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FastAPI åç«¯æœåŠ¡                             â”‚
â”‚                                                               â”‚
â”‚  GET  /api/v1/projects/                                      â”‚
â”‚  GET  /api/v1/projects/{id}/structure_tree                  â”‚
â”‚  GET  /api/v1/assets/?device_id={id}                         â”‚
â”‚  POST /api/v1/assets/upload_image_with_note                  â”‚
â”‚  POST /api/v1/assets/{id}/run_ocr                             â”‚
â”‚  POST /api/v1/assets/{id}/run_scene_llm                       â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PostgreSQL                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  projects   â”‚  â”‚  buildings   â”‚  â”‚   assets     â”‚       â”‚
â”‚  â”‚  zones       â”‚  â”‚  systems     â”‚  â”‚   devices    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ é¡¹ç›®ç»“æ„è®¾è®¡

### Flutter é¡¹ç›®ç›®å½•ç»“æ„

```
lib/
â”œâ”€â”€ main.dart                    # åº”ç”¨å…¥å£
â”œâ”€â”€ app.dart                     # App æ ¹ç»„ä»¶ï¼ˆè·¯ç”±ã€ä¸»é¢˜ï¼‰
â”‚
â”œâ”€â”€ config/                     # é…ç½®
â”‚   â”œâ”€â”€ api_config.dart          # API é…ç½®
â”‚   â”œâ”€â”€ app_config.dart          # åº”ç”¨é…ç½®
â”‚   â””â”€â”€ constants.dart           # å¸¸é‡å®šä¹‰
â”‚
â”œâ”€â”€ models/                     # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ project.dart            # é¡¹ç›®æ¨¡å‹
â”‚   â”œâ”€â”€ building.dart           # æ¥¼æ ‹æ¨¡å‹
â”‚   â”œâ”€â”€ zone.dart               # åŒºåŸŸæ¨¡å‹
â”‚   â”œâ”€â”€ system.dart             # ç³»ç»Ÿæ¨¡å‹
â”‚   â”œâ”€â”€ device.dart             # è®¾å¤‡æ¨¡å‹
â”‚   â”œâ”€â”€ asset.dart              # èµ„äº§æ¨¡å‹
â”‚   â””â”€â”€ user.dart               # ç”¨æˆ·æ¨¡å‹
â”‚
â”œâ”€â”€ services/                   # ä¸šåŠ¡æœåŠ¡
â”‚   â”œâ”€â”€ api_service.dart        # API é€šä¿¡æœåŠ¡
â”‚   â”œâ”€â”€ auth_service.dart       # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ asset_service.dart      # èµ„äº§æœåŠ¡
â”‚   â”œâ”€â”€ sync_service.dart       # æ•°æ®åŒæ­¥æœåŠ¡
â”‚   â””â”€â”€ storage_service.dart    # æœ¬åœ°å­˜å‚¨æœåŠ¡
â”‚
â”œâ”€â”€ providers/                  # çŠ¶æ€ç®¡ç†ï¼ˆRiverpodï¼‰
â”‚   â”œâ”€â”€ project_provider.dart   # é¡¹ç›®çŠ¶æ€
â”‚   â”œâ”€â”€ asset_provider.dart     # èµ„äº§çŠ¶æ€
â”‚   â”œâ”€â”€ auth_provider.dart      # è®¤è¯çŠ¶æ€
â”‚   â””â”€â”€ sync_provider.dart      # åŒæ­¥çŠ¶æ€
â”‚
â”œâ”€â”€ ui/                         # UI é¡µé¢
â”‚   â”œâ”€â”€ pages/                  # é¡µé¢
â”‚   â”‚   â”œâ”€â”€ splash_page.dart    # å¯åŠ¨é¡µ
â”‚   â”‚   â”œâ”€â”€ login_page.dart     # ç™»å½•é¡µ
â”‚   â”‚   â”œâ”€â”€ home_page.dart      # ä¸»é¡µ
â”‚   â”‚   â”œâ”€â”€ projects_page.dart  # é¡¹ç›®åˆ—è¡¨é¡µ
â”‚   â”‚   â”œâ”€â”€ structure_page.dart # å·¥ç¨‹ç»“æ„é¡µ
â”‚   â”‚   â”œâ”€â”€ assets_page.dart    # èµ„äº§åˆ—è¡¨é¡µ
â”‚   â”‚   â””â”€â”€ settings_page.dart  # è®¾ç½®é¡µ
â”‚   â”‚
â”‚   â”œâ”€â”€ widgets/                # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ asset_card.dart     # èµ„äº§å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ device_card.dart    # è®¾å¤‡å¡ç‰‡
â”‚   â”‚   â”œâ”€â”€ image_upload.dart   # å›¾ç‰‡ä¸Šä¼ ç»„ä»¶
â”‚   â”‚   â””â”€â”€ sync_status.dart    # åŒæ­¥çŠ¶æ€æŒ‡ç¤ºå™¨
â”‚   â”‚
â”‚   â””â”€â”€ dialogs/                # å¯¹è¯æ¡†
â”‚       â”œâ”€â”€ confirm_dialog.dart # ç¡®è®¤å¯¹è¯æ¡†
â”‚       â””â”€â”€ loading_dialog.dart # åŠ è½½å¯¹è¯æ¡†
â”‚
â”œâ”€â”€ utils/                      # å·¥å…·ç±»
â”‚   â”œâ”€â”€ http_client.dart        # HTTP å®¢æˆ·ç«¯å°è£…
â”‚   â”œâ”€â”€ logger.dart             # æ—¥å¿—å·¥å…·
â”‚   â”œâ”€â”€ date_utils.dart         # æ—¥æœŸå·¥å…·
â”‚   â””â”€â”€ validators.dart         # éªŒè¯å™¨
â”‚
â””â”€â”€ l10n/                       # å›½é™…åŒ–
    â””â”€â”€ messages_zh_CN.arb      # ä¸­æ–‡ç¿»è¯‘æ–‡ä»¶
```

---

## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—è®¾è®¡

### 1. ç”¨æˆ·è®¤è¯æ¨¡å—

#### 1.1 AuthService

**ä½ç½®**ï¼š`lib/services/auth_service.dart`

```dart
import 'package:http/http.dart' as http;
import 'package:shared_preferences/shared_preferences.dart';
import '../config/api_config.dart';
import '../models/user.dart';

class AuthService {
  final String baseUrl = ApiConfig.baseUrl;
  String? _token;

  // è·å– Token
  String? get token => _token;

  // åˆå§‹åŒ–ï¼ˆä»æœ¬åœ°å­˜å‚¨åŠ è½½ Tokenï¼‰
  Future<void> init() async {
    final prefs = await SharedPreferences.getInstance();
    _token = prefs.getString('auth_token');
  }

  // ç”¨æˆ·ç™»å½•
  Future<User> login(String username, String password) async {
    final response = await http.post(
      Uri.parse('$baseUrl/auth/login'),
      body: {
        'username': username,
        'password': password,
      },
    );

    if (response.statusCode == 200) {
      final data = jsonDecode(response.body);
      _token = data['token'];

      // ä¿å­˜ Token åˆ°æœ¬åœ°
      final prefs = await SharedPreferences.getInstance();
      await prefs.setString('auth_token', _token!);

      return User.fromJson(data['user']);
    } else {
      throw Exception('ç™»å½•å¤±è´¥');
    }
  }

  // ç”¨æˆ·ç™»å‡º
  Future<void> logout() async {
    _token = null;
    final prefs = await SharedPreferences.getInstance();
    await prefs.remove('auth_token');
  }

  // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
  bool get isAuthenticated => _token != null;
}
```

#### 1.2 LoginPage UI

**ä½ç½®**ï¼š`lib/ui/pages/login_page.dart`

```dart
import 'package:flutter/material.dart';
import 'package:provider/provider.dart';
import '../../providers/auth_provider.dart';

class LoginPage extends StatefulWidget {
  @override
  _LoginPageState createState() => _LoginPageState();
}

class _LoginPageState extends State<LoginPage> {
  final _formKey = GlobalKey<FormState>();
  final _usernameController = TextEditingController();
  final _passwordController = TextEditingController();
  bool _isLoading = false;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: SafeArea(
        child: Padding(
          padding: EdgeInsets.all(24.0),
          child: Form(
            key: _formKey,
            child: Column(
              mainAxisAlignment: MainAxisAlignment.center,
              children: [
                // Logo å’Œæ ‡é¢˜
                Icon(Icons.build, size: 80, color: Theme.of(context).primaryColor),
                SizedBox(height: 24),
                Text('BDC-AI', style: Theme.of(context).textTheme.displaySmall),
                Text('å»ºç­‘èŠ‚èƒ½ç®¡ç†å¹³å°', style: Theme.of(context).textTheme.bodyMedium),
                SizedBox(height: 48),

                // ç”¨æˆ·åè¾“å…¥
                TextFormField(
                  controller: _usernameController,
                  decoration: InputDecoration(
                    labelText: 'ç”¨æˆ·å',
                    prefixIcon: Icon(Icons.person),
                    border: OutlineInputBorder(),
                  ),
                  validator: (value) => value?.isEmpty ?? true ? 'è¯·è¾“å…¥ç”¨æˆ·å' : null,
                ),
                SizedBox(height: 16),

                // å¯†ç è¾“å…¥
                TextFormField(
                  controller: _passwordController,
                  decoration: InputDecoration(
                    labelText: 'å¯†ç ',
                    prefixIcon: Icon(Icons.lock),
                    border: OutlineInputBorder(),
                  ),
                  obscureText: true,
                  validator: (value) => value?.isEmpty ?? true ? 'è¯·è¾“å…¥å¯†ç ' : null,
                ),
                SizedBox(height: 24),

                // ç™»å½•æŒ‰é’®
                SizedBox(
                  width: double.infinity,
                  height: 48,
                  child: ElevatedButton(
                    onPressed: _isLoading ? null : _handleLogin,
                    child: _isLoading
                        ? CircularProgressIndicator(color: Colors.white)
                        : Text('ç™»å½•'),
                  ),
                ),
              ],
            ),
          ),
        ),
      ),
    );
  }

  Future<void> _handleLogin() async {
    if (!_formKey.currentState!.validate()) return;

    setState(() => _isLoading = true);

    try {
      final authProvider = context.read<AuthProvider>();
      await authProvider.login(
        _usernameController.text,
        _passwordController.text,
      );

      // ç™»å½•æˆåŠŸï¼Œè·³è½¬åˆ°ä¸»é¡µ
      Navigator.of(context).pushReplacementNamed('/home');
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('ç™»å½•å¤±è´¥ï¼š$e')),
      );
    } finally {
      setState(() => _isLoading = false);
    }
  }
}
```

---

### 2. èµ„äº§é‡‡é›†æ¨¡å—

#### 2.1 AssetService

**ä½ç½®**ï¼š`lib/services/asset_service.dart`

```dart
import 'dart:io';
import 'package:http/http.dart' as http;
import 'package:path_provider/path_provider.dart';
import 'package:image_picker/image_picker.dart';
import '../config/api_config.dart';
import '../models/asset.dart';

class AssetService {
  final String baseUrl = ApiConfig.baseUrl;
  final ImagePicker _picker = ImagePicker();

  // ä¸Šä¼ å›¾ç‰‡ï¼ˆå¸¦å…ƒæ•°æ®ï¼‰
  Future<Asset> uploadImage({
    required File imageFile,
    required String projectId,
    String? deviceId,
    String note = '',
    String modality = 'image',
    String contentRole = 'scene_issue',
  }) async {
    var request = http.MultipartRequest(
      'POST',
      Uri.parse('$baseUrl/assets/upload_image_with_note'),
    );

    // æ·»åŠ æ–‡ä»¶
    request.files.add(
      await http.MultipartFile.fromPath('file', imageFile.path),
    );

    // æ·»åŠ å…ƒæ•°æ®
    request.fields['project_id'] = projectId;
    if (deviceId != null) {
      request.fields['device_id'] = deviceId!;
    }
    request.fields['note'] = note;
    request.fields['modality'] = modality;
    request.fields['content_role'] = contentRole;

    // å‘é€è¯·æ±‚
    var response = await request.send();

    if (response.statusCode == 201) {
      final resp = await http.Response.fromStream(response);
      return Asset.fromJson(jsonDecode(resp.body));
    } else {
      throw Exception('ä¸Šä¼ å¤±è´¥');
    }
  }

  // ä»ç›¸æœºé€‰æ‹©å›¾ç‰‡
  Future<File?> pickImageFromCamera() async {
    final XFile? photo = await _picker.pickImage(source: ImageSource.camera);
    if (photo != null) {
      return File(photo.path);
    }
    return null;
  }

  // ä»ç›¸å†Œé€‰æ‹©å›¾ç‰‡
  Future<File?> pickImageFromGallery() async {
    final XFile? image = await _picker.pickImage(source: ImageSource.gallery);
    if (image != null) {
      return File(image.path);
    }
    return null;
  }

  // è·å–è®¾å¤‡èµ„äº§åˆ—è¡¨
  Future<List<Asset>> getDeviceAssets(String deviceId) async {
    final response = await http.get(
      Uri.parse('$baseUrl/assets/?device_id=$deviceId'),
    );

    if (response.statusCode == 200) {
      final List<dynamic> data = jsonDecode(response.body);
      return data.map((json) => Asset.fromJson(json)).toList();
    } else {
      throw Exception('è·å–èµ„äº§åˆ—è¡¨å¤±è´¥');
    }
  }

  // è¿è¡Œ OCR
  Future<void> runOCR(String assetId) async {
    final response = await http.post(
      Uri.parse('$baseUrl/assets/$assetId/run_ocr'),
    );

    if (response.statusCode != 200) {
      throw Exception('OCR å¤±è´¥');
    }
  }

  // è¿è¡Œ GLM-4V åˆ†æ
  Future<void> runSceneLLM(String assetId) async {
    final response = await http.post(
      Uri.parse('$baseUrl/assets/$assetId/run_scene_llm'),
    );

    if (response.statusCode != 200) {
      throw Exception('GLM åˆ†æå¤±è´¥');
    }
  }
}
```

#### 2.2 å›¾ç‰‡ä¸Šä¼  UI

**ä½ç½®**ï¼š`lib/ui/pages/assets_page.dart`

```dart
import 'package:flutter/material.dart';
import 'package:image_picker/image_picker.dart';
import '../../services/asset_service.dart';
import '../../widgets/asset_card.dart';

class AssetsPage extends StatefulWidget {
  final String deviceId;

  const AssetsPage({required this.deviceId});

  @override
  _AssetsPageState createState() => _AssetsPageState();
}

class _AssetsPageState extends State<AssetsPage> {
  final AssetService _assetService = AssetService();
  List<Asset> _assets = [];
  bool _isLoading = false;

  @override
  void initState() {
    super.initState();
    _loadAssets();
  }

  Future<void> _loadAssets() async {
    setState(() => _isLoading = true);

    try {
      final assets = await _assetService.getDeviceAssets(widget.deviceId);
      setState(() => _assets = assets);
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('åŠ è½½å¤±è´¥ï¼š$e')),
      );
    } finally {
      setState(() => _isLoading = false);
    }
  }

  Future<void> _pickAndUploadImage(ImageSource source) async {
    try {
      // é€‰æ‹©å›¾ç‰‡
      final File? image = await source == ImageSource.camera
          ? await _assetService.pickImageFromCamera()
          : await _assetService.pickImageFromGallery();

      if (image == null) return;

      // æ˜¾ç¤ºå¤‡æ³¨è¾“å…¥å¯¹è¯æ¡†
      final note = await _showNoteInputDialog();

      if (note == null) return;

      // ä¸Šä¼ 
      setState(() => _isLoading = true);

      final asset = await _assetService.uploadImage(
        imageFile: image,
        projectId: 'current-project-id', // ä»çŠ¶æ€ç®¡ç†è·å–
        deviceId: widget.deviceId,
        note: note,
      );

      // åˆ·æ–°åˆ—è¡¨
      await _loadAssets();

      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('ä¸Šä¼ æˆåŠŸ')),
      );
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('ä¸Šä¼ å¤±è´¥ï¼š$e')),
      );
    } finally {
      setState(() => _isLoading = false);
    }
  }

  Future<String?> _showNoteInputDialog() async {
    final controller = TextEditingController();
    return showDialog<String>(
      context: context,
      builder: (context) => AlertDialog(
        title: Text('æ·»åŠ å¤‡æ³¨'),
        content: TextField(
          controller: controller,
          decoration: InputDecoration(
            hintText: 'è¯·è¾“å…¥å·¥ç¨‹å¸ˆå¤‡æ³¨...',
          ),
          maxLines: 3,
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text('å–æ¶ˆ'),
          ),
          TextButton(
            onPressed: () => Navigator.pop(context, controller.text),
            child: Text('ç¡®å®š'),
          ),
        ],
      ),
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('èµ„äº§åˆ—è¡¨'),
        actions: [
          // ç›¸æœºæŒ‰é’®
          IconButton(
            icon: Icon(Icons.camera_alt),
            onPressed: () => _pickAndUploadImage(ImageSource.camera),
          ),
          // ç›¸å†ŒæŒ‰é’®
          IconButton(
            icon: Icon(Icons.photo_library),
            onPressed: () => _pickAndUploadImage(ImageSource.gallery),
          ),
        ],
      ),
      body: _isLoading
          ? Center(child: CircularProgressIndicator())
          : _assets.isEmpty
              ? Center(child: Text('æš‚æ— èµ„äº§'))
              : ListView.builder(
                  itemCount: _assets.length,
                  itemBuilder: (context, index) {
                    return AssetCard(asset: _assets[index]);
                  },
                ),
    );
  }
}
```

---

### 3. æ•°æ®åŒæ­¥æ¨¡å—

#### 3.1 SyncService

**ä½ç½®**ï¼š`lib/services/sync_service.dart`

```dart
import 'dart:io';
import 'package:sqflite/sqflite.dart';
import 'package:path_provider/path_provider.dart';
import 'package:connectivity_plus/connectivity_plus.dart';
import 'package:http/http.dart' as http;
import '../config/api_config.dart';

class SyncService {
  final String baseUrl = ApiConfig.baseUrl;
  Database? _db;

  // åˆå§‹åŒ–æ•°æ®åº“
  Future<void> init() async {
    final docsDir = await getApplicationDocumentsDirectory();
    final dbPath = '${docsDir.path}/bdc_ai.db';

    _db = await openDatabase(
      dbPath,
      version: 1,
      onCreate: (db) async {
        // åˆ›å»ºå¾…ä¸Šä¼ è¡¨
        await db.execute('''
          CREATE TABLE pending_uploads (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            type TEXT NOT NULL,
            data TEXT NOT NULL,
            created_at INTEGER NOT NULL
          )
        ''');

        // åˆ›å»ºæœ¬åœ°èµ„äº§ç¼“å­˜è¡¨
        await db.execute('''
          CREATE TABLE cached_assets (
            id TEXT PRIMARY KEY,
            project_id TEXT,
            device_id TEXT,
            title TEXT,
            modality TEXT,
            download_url TEXT,
            created_at INTEGER,
            updated_at INTEGER
          )
        ''');
      },
    );
  }

  // æ·»åŠ å¾…ä¸Šä¼ è®°å½•
  Future<void> addPendingUpload(String type, Map<String, dynamic> data) async {
    await _db!.insert(
      'pending_uploads',
      {
        'type': type,
        'data': jsonEncode(data),
        'created_at': DateTime.now().millisecondsSinceEpoch,
      },
    );
  }

  // ä¸Šä¼ æœ¬åœ°å˜æ›´
  Future<void> uploadPendingChanges() async {
    final pending = await _db!.query('pending_uploads');

    for (var row in pending.rows) {
      try {
        final type = row['type'];
        final data = jsonDecode(row['data']);

        http.Response response;

        if (type == 'asset') {
          // ä¸Šä¼ èµ„äº§
          final file = File(data['file_path']);
          var request = http.MultipartRequest(
            'POST',
            Uri.parse('$baseUrl/assets/upload_image_with_note'),
          );
          request.files.add(await http.MultipartFile.fromPath('file', file.path));
          request.fields.addAll(data['metadata']);

          response = await request.send();
        }

        if (response.statusCode == 201) {
          // æˆåŠŸï¼Œåˆ é™¤å¾…ä¸Šä¼ è®°å½•
          await _db!.delete(
            'pending_uploads',
            where: 'id = ?',
            whereArgs: [row['id']],
          );
        }
      } catch (e) {
        print('ä¸Šä¼ å¤±è´¥: $e');
      }
    }
  }

  // ä¸‹è½½è¿œç¨‹æ•°æ®
  Future<void> downloadRemoteData(String projectId) async {
    try {
      final response = await http.get(
        Uri.parse('$baseUrl/projects/$projectId/assets'),
      );

      if (response.statusCode == 200) {
        final List<dynamic> assets = jsonDecode(response.body);

        for (var assetJson in assets) {
          await _db!.insert(
            'cached_assets',
            {
              'id': assetJson['id'],
              'project_id': assetJson['project_id'],
              'device_id': assetJson['device_id'] ?? '',
              'title': assetJson['title'] ?? '',
              'modality': assetJson['modality'],
              'download_url': assetJson['download_url'] ?? '',
              'created_at': DateTime.parse(assetJson['created_at']).millisecondsSinceEpoch,
              'updated_at': DateTime.parse(assetJson['updated_at']).millisecondsSinceEpoch,
            },
            conflictAlgorithm: ConflictAlgorithm.replace,
          );
        }
      }
    } catch (e) {
      print('ä¸‹è½½å¤±è´¥: $e');
    }
  }

  // è·å–æœ¬åœ°ç¼“å­˜çš„èµ„äº§
  Future<List<Map<String, dynamic>>> getCachedAssets(String deviceId) async {
    final assets = await _db!.query(
      'cached_assets',
      where: 'device_id = ?',
      whereArgs: [deviceId],
      orderBy: 'updated_at DESC',
    );

    return assets.toList();
  }

  // ç›‘å¬ç½‘ç»œçŠ¶æ€
  void startSync() {
    Connectivity().onConnectivityChanged.listen((ConnectivityResult result) async {
      if (result != ConnectivityResult.none) {
        print('ç½‘ç»œå·²è¿æ¥ï¼Œå¼€å§‹åŒæ­¥...');
        await uploadPendingChanges();
        // await downloadRemoteData(); // æ ¹æ®éœ€è¦ä¸‹è½½
      } else {
        print('ç½‘ç»œå·²æ–­å¼€');
      }
    });
  }

  // è·å–ç½‘ç»œçŠ¶æ€
  Future<bool> isOnline() async {
    final result = await Connectivity().checkConnectivity();
    return result != ConnectivityResult.none;
  }
}
```

#### 3.2 åŒæ­¥çŠ¶æ€æŒ‡ç¤ºå™¨

**ä½ç½®**ï¼š`lib/ui/widgets/sync_status.dart`

```dart
import 'package:flutter/material.dart';
import 'package:connectivity_plus/connectivity_plus.dart';

class SyncStatusIndicator extends StatefulWidget {
  @override
  _SyncStatusIndicatorState createState() => _SyncStatusIndicatorState();
}

class _SyncStatusIndicatorState extends State<SyncStatusIndicator> {
  ConnectivityResult _connectionStatus = ConnectivityResult.none;

  @override
  void initState() {
    super.initState();
    _checkConnection();
    Connectivity().onConnectivityChanged.listen((result) {
      setState(() => _connectionStatus = result);
    });
  }

  Future<void> _checkConnection() async {
    final result = await Connectivity().checkConnectivity();
    setState(() => _connectionStatus = result);
  }

  @override
  Widget build(BuildContext context) {
    return Row(
      mainAxisSize: MainAxisSize.min,
      children: [
        Icon(
          _connectionStatus == ConnectivityResult.none
              ? Icons.cloud_off
              : Icons.cloud_done,
          size: 16,
          color: _connectionStatus == ConnectivityResult.none
              ? Colors.red
              : Colors.green,
        ),
        SizedBox(width: 4),
        Text(
          _connectionStatus == ConnectivityResult.none ? 'ç¦»çº¿' : 'åœ¨çº¿',
          style: TextStyle(fontSize: 12),
        ),
      ],
    );
  }
}
```

---

### 4. äºŒç»´ç æ‰«ææ¨¡å—

#### 4.1 DeviceScanner

**ä½ç½®**ï¼š`lib/ui/pages/scan_page.dart`

```dart
import 'package:flutter/material.dart';
import 'package:mobile_scanner/mobile_scanner.dart';
import '../../services/api_service.dart';

class DeviceScannerPage extends StatefulWidget {
  @override
  _DeviceScannerPageState createState() => _DeviceScannerPageState();
}

class _DeviceScannerPageState extends State<DeviceScannerPage> {
  bool _isScanning = false;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('æ‰«æè®¾å¤‡äºŒç»´ç '),
      ),
      body: _isScanning
          ? MobileScanner(
              controller: MobileScannerController(
                onDetect: (barcode) async {
                  // æ‰«ææˆåŠŸ
                  final barcodeValue = barcode.rawValue ?? '';
                  await _handleScanResult(barcodeValue);
                },
              ),
              onDetectError: (error, controller) {
                // æ‰«æé”™è¯¯
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text('æ‰«æé”™è¯¯ï¼š$error')),
                );
              },
            )
          : Center(
              child: ElevatedButton.icon(
                icon: Icon(Icons.qr_code_scanner),
                label: Text('å¼€å§‹æ‰«æ'),
                onPressed: () => setState(() => _isScanning = true),
              ),
            ),
    );
  }

  Future<void> _handleScanResult(String qrCode) async {
    setState(() => _isScanning = false);

    // è§£æ QR Codeï¼ˆæ ¼å¼ï¼šbdc://device/{device_id}ï¼‰
    if (qrCode.startsWith('bdc://device/')) {
      final deviceId = qrCode.replace('bdc://device/', '');

      // è·³è½¬åˆ°è®¾å¤‡è¯¦æƒ…é¡µ
      Navigator.of(context).pushReplacementNamed(
        '/device/$deviceId',
      );
    } else {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('æ— æ•ˆçš„è®¾å¤‡äºŒç»´ç ')),
      );
    }
  }
}
```

---

## ğŸ“… åˆ†é˜¶æ®µå®æ–½è®¡åˆ’

### é˜¶æ®µ 1ï¼šåŸºç¡€æ¡†æ¶æ­å»ºï¼ˆ1 å‘¨ï¼‰

**ç›®æ ‡**ï¼šæ­å»º Flutter é¡¹ç›®åŸºç¡€æ¶æ„

**ä»»åŠ¡æ¸…å•**ï¼š
- [x] åˆ›å»º Flutter é¡¹ç›®
- [ ] é…ç½®é¡¹ç›®ç»“æ„
- [ ] é›†æˆä¾èµ–åŒ…ï¼ˆhttp, sqflite, image_picker, connectivity_plus ç­‰ï¼‰
- [ ] é…ç½®è·¯ç”±å’Œä¸»é¢˜
- [ ] å®ç° HTTP å®¢æˆ·ç«¯å°è£…
- [ ] å®ç°æœ¬åœ°å­˜å‚¨æœåŠ¡ï¼ˆSQLiteï¼‰
- [ ] å®ç°çŠ¶æ€ç®¡ç†ï¼ˆRiverpodï¼‰
- [ ] åˆ›å»ºåŸºç¡€ UI ç»„ä»¶

**éªŒæ”¶æ ‡å‡†**ï¼š
- é¡¹ç›®å¯ä»¥æ­£å¸¸å¯åŠ¨
- å¯ä»¥å‘èµ· HTTP è¯·æ±‚åˆ°åç«¯ API
- SQLite æ•°æ®åº“æ­£å¸¸å·¥ä½œ

---

### é˜¶æ®µ 2ï¼šç”¨æˆ·è®¤è¯åŠŸèƒ½ï¼ˆ2-3 å¤©ï¼‰

**ç›®æ ‡**ï¼šå®ç°ç”¨æˆ·ç™»å½•/ç™»å‡º

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] è®¾è®¡ç™»å½•é¡µé¢ UI
- [ ] å®ç° AuthService
- [ ] å®ç° AuthProviderï¼ˆRiverpodï¼‰
- [ ] å®ç° Token å­˜å‚¨
- [ ] å®ç°è‡ªåŠ¨ç™»å½•
- [ ] æ·»åŠ ç™»å‡ºåŠŸèƒ½
- [ ] æµ‹è¯•è®¤è¯æµç¨‹

**éªŒæ”¶æ ‡å‡†**ï¼š
- å¯ä»¥æ­£å¸¸ç™»å½•
- Token æ­£ç¡®ä¿å­˜åˆ°æœ¬åœ°
- åº”ç”¨é‡å¯åè‡ªåŠ¨ç™»å½•
- ç™»å‡ºåæ¸…é™¤ Token

---

### é˜¶æ®µ 3ï¼šå·¥ç¨‹ç»“æ„æµè§ˆï¼ˆ3-4 å¤©ï¼‰

**ç›®æ ‡**ï¼šå®ç°å·¥ç¨‹ç»“æ„æ ‘æµè§ˆåŠŸèƒ½

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] è®¾è®¡å·¥ç¨‹ç»“æ„æ ‘ UI
- [ ] å®ç° StructureServiceï¼ˆè°ƒç”¨åç«¯ APIï¼‰
- [ ] å®ç°æ ‘èŠ‚ç‚¹ç‚¹å‡»äº‹ä»¶
- [ ] å®ç°è®¾å¤‡åˆ—è¡¨å±•ç¤º
- [ ] æ·»åŠ ä¸‹æ‹‰åˆ·æ–°
- [ ] æ·»åŠ æœç´¢åŠŸèƒ½
- [ ] å®ç°ç¦»çº¿ç¼“å­˜ï¼ˆSQLiteï¼‰

**API æ¥å£**ï¼š
- `GET /api/v1/projects/{id}/structure_tree`
- `GET /api/v1/devices/{id}/assets`

**éªŒæ”¶æ ‡å‡†**ï¼š
- å¯ä»¥æ­£å¸¸å±•ç¤ºå·¥ç¨‹ç»“æ„æ ‘
- ç‚¹å‡»èŠ‚ç‚¹è·³è½¬åˆ°å¯¹åº”é¡µé¢
- ç¦»çº¿æ—¶å¯ä»¥æµè§ˆç¼“å­˜çš„å·¥ç¨‹ç»“æ„

---

### é˜¶æ®µ 4ï¼šèµ„äº§é‡‡é›†åŠŸèƒ½ï¼ˆ4-5 å¤©ï¼‰

**ç›®æ ‡**ï¼šå®ç°å›¾ç‰‡/è¯­éŸ³/æ–‡å­—é‡‡é›†

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] å®ç°ç›¸æœºæ‹ç…§åŠŸèƒ½
- [ ] å®ç°ç›¸å†Œé€‰æ‹©åŠŸèƒ½
- [ ] å®ç°å›¾ç‰‡ä¸Šä¼ ï¼ˆAssetServiceï¼‰
- [ ] å®ç°å·¥ç¨‹å¸ˆå¤‡æ³¨è¾“å…¥
- [ ] å®ç° GPS ä½ç½®è®°å½•
- [ ] å®ç°èµ„äº§åˆ—è¡¨å±•ç¤º
- [ ] æ·»åŠ èµ„äº§è¯¦æƒ…é¡µ
- [ ] å®ç°èµ„äº§åˆ é™¤åŠŸèƒ½

**API æ¥å£**ï¼š
- `POST /api/v1/assets/upload_image_with_note`
- `GET /api/v1/assets/?device_id={id}`
- `DELETE /api/v1/assets/{id}`

**éªŒæ”¶æ ‡å‡†**ï¼š
- å¯ä»¥æ­£å¸¸æ‹ç…§ä¸Šä¼ 
- å¯ä»¥æ·»åŠ å¤‡æ³¨å’Œä½ç½®ä¿¡æ¯
- èµ„äº§åˆ—è¡¨æ­£å¸¸å±•ç¤º
- ä¸Šä¼ çš„å›¾ç‰‡å¯ä»¥åœ¨ PC ç«¯çœ‹åˆ°

---

### é˜¶æ®µ 5ï¼šæ•°æ®åŒæ­¥åŠŸèƒ½ï¼ˆ3-4 å¤©ï¼‰

**ç›®æ ‡**ï¼šå®ç°ç¦»çº¿æ•°æ®åŒæ­¥

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] å®ç°æœ¬åœ° SQLite æ•°æ®åº“
- [ ] å®ç°å¾…ä¸Šä¼ è®°å½•è¡¨
- [ ] å®ç°ç½‘ç»œçŠ¶æ€ç›‘å¬
- [ ] å®ç°è‡ªåŠ¨åŒæ­¥ï¼ˆç½‘ç»œæ¢å¤åï¼‰
- [ ] å®ç°æ‰‹åŠ¨åŒæ­¥æŒ‰é’®
- [ ] æ·»åŠ åŒæ­¥çŠ¶æ€æŒ‡ç¤ºå™¨
- [ ] å®ç°å†²çªæ£€æµ‹ä¸è§£å†³
- [ ] æµ‹è¯•ç¦»çº¿åœºæ™¯

**éªŒæ”¶æ ‡å‡†**ï¼š
- ç¦»çº¿æ—¶å¯ä»¥æ­£å¸¸é‡‡é›†æ•°æ®
- ç½‘ç»œæ¢å¤åè‡ªåŠ¨ä¸Šä¼ 
- ä¸ä¼šä¸¢å¤±æ•°æ®
- å†²çªå¯ä»¥æ­£ç¡®å¤„ç†

---

### é˜¶æ®µ 6ï¼šäºŒç»´ç æ‰«æï¼ˆ2-3 å¤©ï¼‰

**ç›®æ ‡**ï¼šå®ç°è®¾å¤‡äºŒç»´ç æ‰«æ

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] é›†æˆäºŒç»´ç æ‰«æåº“
- [ ] å®ç° ScannerPage
- [ ] å®ç° QR Code ç”Ÿæˆï¼ˆåç«¯ï¼‰
- [ ] å®ç°æ‰«æç»“æœè§£æ
- [ ] å®ç°è·³è½¬åˆ°è®¾å¤‡è¯¦æƒ…
- [ ] æ·»åŠ æ‰«æå†å²è®°å½•

**éªŒæ”¶æ ‡å‡†**ï¼š
- å¯ä»¥æ­£å¸¸æ‰«æè®¾å¤‡äºŒç»´ç 
- æ‰«æåè·³è½¬åˆ°å¯¹åº”è®¾å¤‡
- äºŒç»´ç åŒ…å«è®¾å¤‡ä¿¡æ¯

---

### é˜¶æ®µ 7ï¼šä¼˜åŒ–ä¸æµ‹è¯•ï¼ˆ3-4 å¤©ï¼‰

**ç›®æ ‡**ï¼šå®Œå–„åŠŸèƒ½ï¼Œä¼˜åŒ–ä½“éªŒ

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆå›¾ç‰‡å‹ç¼©ã€æ‡’åŠ è½½ï¼‰
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–ï¼ˆåŠ è½½çŠ¶æ€ã€é”™è¯¯æç¤ºï¼‰
- [ ] æ·»åŠ å›½é™…åŒ–æ”¯æŒ
- [ ] æ·»åŠ æ—¥å¿—ç³»ç»Ÿ
- [ ] åŠŸèƒ½æµ‹è¯•ï¼ˆæ­£å¸¸åœºæ™¯ã€å¼‚å¸¸åœºæ™¯ï¼‰
- [ ] å…¼å®¹æ€§æµ‹è¯•ï¼ˆiOSã€Androidï¼‰
- [ ] ç¦»çº¿åœºæ™¯æµ‹è¯•
- [ ] ç¼–å†™ç”¨æˆ·æ–‡æ¡£

**éªŒæ”¶æ ‡å‡†**ï¼š
- åº”ç”¨æµç•…æ— å¡é¡¿
- é”™è¯¯æç¤ºå‹å¥½
- iOS å’Œ Android éƒ½èƒ½æ­£å¸¸è¿è¡Œ

---

## ğŸ“Š å¼€å‘æ—¶é—´ä¼°ç®—

| é˜¶æ®µ | ä»»åŠ¡ | æ—¶é—´ | ç´¯è®¡æ—¶é—´ |
|------|------|------|----------|
| 1 | åŸºç¡€æ¡†æ¶æ­å»º | 1 å‘¨ | 1 å‘¨ |
| 2 | ç”¨æˆ·è®¤è¯åŠŸèƒ½ | 2-3 å¤© | 1.5 å‘¨ |
| 3 | å·¥ç¨‹ç»“æ„æµè§ˆ | 3-4 å¤© | 2 å‘¨ |
| 4 | èµ„äº§é‡‡é›†åŠŸèƒ½ | 4-5 å¤© | 2.5-3 å‘¨ |
| 5 | æ•°æ®åŒæ­¥åŠŸèƒ½ | 3-4 å¤© | 3-3.5 å‘¨ |
| 6 | äºŒç»´ç æ‰«æ | 2-3 å¤© | 3.5-4 å‘¨ |
| 7 | ä¼˜åŒ–ä¸æµ‹è¯• | 3-4 å¤© | 4-4.5 å‘¨ |

**æ€»è®¡**ï¼š4-4.5 å‘¨ï¼ˆçº¦ 1 ä¸ªæœˆï¼‰

---

## ğŸ” å®‰å…¨ä¸æƒé™

### 1. API å®‰å…¨

**Token ç®¡ç†**ï¼š
```dart
// è¯·æ±‚å¤´æ·»åŠ  Token
final response = await http.get(
  Uri.parse('$baseUrl/projects'),
  headers: {
    'Authorization': 'Bearer $_token',
    'Content-Type': 'application/json',
  },
);
```

**HTTPS å¼ºåˆ¶**ï¼š
- ç”Ÿäº§ç¯å¢ƒå¼ºåˆ¶ä½¿ç”¨ HTTPS
- å¼€å‘ç¯å¢ƒå¯ä»¥ä½¿ç”¨ HTTPï¼ˆé…ç½®ç™½åå•ï¼‰

### 2. æ•°æ®åŠ å¯†

**æœ¬åœ°æ•°æ®åº“åŠ å¯†**ï¼š
```dart
// ä½¿ç”¨ sqflite_sqlcipher åŠ å¯†æ•°æ®åº“
import 'package:sqflite_sqlcipher/sqflite_sqlcipher.dart';

await openDatabase(
  dbPath,
  password: 'your-encryption-key', // åŠ å¯†å¯†é’¥
  version: 1,
);
```

**æ•æ„Ÿæ•°æ®åŠ å¯†**ï¼š
- Token å­˜å‚¨ä½¿ç”¨ `flutter_secure_storage`
- å¯†ç ç­‰æ•æ„Ÿæ•°æ®ä½¿ç”¨åŠ å¯†å­˜å‚¨

---

## ğŸš€ éƒ¨ç½²ä¸å‘å¸ƒ

### 1. Android æ‰“åŒ…

**ç”Ÿæˆç­¾åå¯†é’¥**ï¼š
```bash
keytool -genkey -v -keystore bdc-ai.keystore -alias bdc-ai -keyalg RSA -keysize 2048 -validity 10000
```

**é…ç½®ç­¾å**ï¼š
```dart
// android/app/build.gradle
android {
    signingConfigs {
        release {
            keyAlias keystoreProperties['keyAlias']
            keyPassword keystoreProperties['keyPassword']
            storeFile keystoreProperties['storeFile'] ? file(keystoreProperties['storeFile']) : null
            storePassword keystoreProperties['storePassword']
        }
    }
    buildTypes {
        release {
            signingConfig signingConfigs.release
        }
    }
}
```

**æ‰“åŒ…**ï¼š
```bash
flutter build apk --release
flutter build appbundle --release
```

### 2. iOS æ‰“åŒ…

**é…ç½®ç­¾å**ï¼š
- åœ¨ Xcode ä¸­é…ç½®å¼€å‘è€…è´¦å·
- é…ç½® Bundle Identifier
- é…ç½®ç­¾åè¯ä¹¦

**æ‰“åŒ…**ï¼š
```bash
flutter build ios --release
```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®è§„åˆ’æ–‡æ¡£](../00-é¡¹ç›®æ€»è§ˆ/é¡¹ç›®è§„åˆ’.md) - é¡¹ç›®æ•´ä½“è§„åˆ’
- [å¤šç«¯äº’é€šæŠ€æœ¯æ–¹æ¡ˆ](./å¤šç«¯äº’é€šæŠ€æœ¯æ–¹æ¡ˆ.md) - å¤šç«¯æŠ€æœ¯æ–¹æ¡ˆ
- [API ä½¿ç”¨ç¤ºä¾‹](../01-å¼€å‘æŒ‡å—/APIä½¿ç”¨ç¤ºä¾‹.md) - API æ¥å£æ–‡æ¡£

---

## ğŸ“ è”ç³»ä¸åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚

---

**æ–‡æ¡£ç»´æŠ¤**ï¼šBDC-AI å¼€å‘å›¢é˜Ÿ
**æœ€åæ›´æ–°**ï¼š2026-01-23
**æ–‡æ¡£ç‰ˆæœ¬**ï¼š1.0.0
