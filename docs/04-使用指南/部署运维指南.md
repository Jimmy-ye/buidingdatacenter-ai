# BDC-AI éƒ¨ç½²è¿ç»´æŒ‡å—

---
**æ ‡é¢˜**: éƒ¨ç½²è¿ç»´æŒ‡å—
**æœ€åæ›´æ–°**: 2026-01-25
**é€‚ç”¨å¯¹è±¡**: è¿ç»´äººå‘˜ã€DevOpså·¥ç¨‹å¸ˆ
**éš¾åº¦ç­‰çº§**: â­â­â­â­
**é¢„è®¡é˜…è¯»æ—¶é—´**: 45 åˆ†é’Ÿ
---

## ğŸ“‹ ç›®å½•

1. [æ¦‚è¿°](#1-æ¦‚è¿°)
2. [ç¯å¢ƒå‡†å¤‡](#2-ç¯å¢ƒå‡†å¤‡)
3. [åç«¯éƒ¨ç½²](#3-åç«¯éƒ¨ç½²)
4. [ç§»åŠ¨ç«¯éƒ¨ç½²](#4-ç§»åŠ¨ç«¯éƒ¨ç½²)
5. [PC-UI éƒ¨ç½²](#5-pc-ui-éƒ¨ç½²)
6. [ç›‘æ§å’Œæ—¥å¿—](#6-ç›‘æ§å’Œæ—¥å¿—)
7. [å¤‡ä»½å’Œæ¢å¤](#7-å¤‡ä»½å’Œæ¢å¤)
8. [å®‰å…¨åŠ å›º](#8-å®‰å…¨åŠ å›º)
9. [è¿ç»´æ“ä½œ](#9-è¿ç»´æ“ä½œ)
10. [æ•…éšœæ’æŸ¥](#10-æ•…éšœæ’æŸ¥)
11. [æœ€ä½³å®è·µ](#11-æœ€ä½³å®è·µ)

---

## 1. æ¦‚è¿°

### 1.1 ç³»ç»Ÿæ¶æ„

BDC-AI é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   BDC-AI æ¶æ„                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ ç§»åŠ¨ç«¯   â”‚  â”‚  PC-UI   â”‚  â”‚ Web UI   â”‚        â”‚
â”‚  â”‚(Flutter) â”‚  â”‚(NiceGUI) â”‚  â”‚ (æœªæ¥)   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚             â”‚             â”‚                â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                     â”‚                               â”‚
â”‚                     â–¼                               â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚       â”‚   API Gateway       â”‚                     â”‚
â”‚       â”‚   (Nginx/å¯é€‰)      â”‚                     â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                  â”‚                                â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚       â”‚   FastAPI Backend   â”‚                     â”‚
â”‚       â”‚   (ç«¯å£: 8000)      â”‚                     â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                  â”‚                                â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚       â”‚                                  â”‚        â”‚
â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚        â”‚
â”‚  â”‚PostgreSQLâ”‚  â”‚  MinIO   â”‚  â”‚ GLM API â”‚ â”‚        â”‚
â”‚  â”‚(5432)   â”‚  â”‚ (9000)   â”‚  â”‚ (å¤–éƒ¨)  â”‚ â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚        â”‚
â”‚                                          â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
```

### 1.2 éƒ¨ç½²æ¶æ„

#### å¼€å‘ç¯å¢ƒ

```
æœ¬åœ°è®¡ç®—æœº
â”œâ”€â”€ åç«¯æœåŠ¡ (localhost:8000)
â”œâ”€â”€ PC-UI (localhost:8080)
â”œâ”€â”€ PostgreSQL (localhost:5432)
â””â”€â”€ ç§»åŠ¨ç«¯æ¨¡æ‹Ÿå™¨
```

#### ç”Ÿäº§ç¯å¢ƒ

```
æœåŠ¡å™¨
â”œâ”€â”€ Nginx (åå‘ä»£ç†, SSL)
â”œâ”€â”€ FastAPI Backend (systemd æœåŠ¡)
â”œâ”€â”€ PostgreSQL (ç³»ç»ŸæœåŠ¡)
â”œâ”€â”€ MinIO (systemd æœåŠ¡, å¯é€‰)
â””â”€â”€ ç›‘æ§å‘Šè­¦ç³»ç»Ÿ
```

### 1.3 æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯æ ˆ | ç‰ˆæœ¬ |
|-----|-------|------|
| åç«¯æ¡†æ¶ | FastAPI | 0.104.1 |
| æ•°æ®åº“ | PostgreSQL | 18.1 |
| å¯¹è±¡å­˜å‚¨ | MinIO | æœ€æ–°ç‰ˆï¼ˆå¯é€‰ï¼‰ |
| Python | Python | 3.11+ |
| Web æœåŠ¡å™¨ | Uvicorn | 0.24.0 |
| åå‘ä»£ç† | Nginx | 1.18+ï¼ˆå¯é€‰ï¼‰ |

---

## 2. ç¯å¢ƒå‡†å¤‡

### 2.1 ç¡¬ä»¶è¦æ±‚

| é…ç½® | æœ€ä½é…ç½® | æ¨èé…ç½® | è¯´æ˜ |
|------|---------|---------|------|
| CPU | 4 æ ¸ | 8 æ ¸ | å¤„ç†å›¾ç‰‡åˆ†æä»»åŠ¡ |
| å†…å­˜ | 8 GB | 16 GB | PostgreSQL + FastAPI + Worker |
| å­˜å‚¨ | 100 GB SSD | 500 GB SSD | æ•°æ®åº“ + æ–‡ä»¶å­˜å‚¨ |
| ç½‘ç»œ | - | 100 Mbps | ç§»åŠ¨ç«¯è®¿é—® |

### 2.2 æ“ä½œç³»ç»Ÿ

æ”¯æŒä»¥ä¸‹æ“ä½œç³»ç»Ÿï¼š

- âœ… **Windows 10/11**ï¼ˆæ¨èï¼Œæ˜“äºç®¡ç†ï¼‰
- âœ… **Windows Server 2019+**
- âœ… **Ubuntu 22.04 LTS**ï¼ˆæ¨èï¼Œç¨³å®šæ€§å¥½ï¼‰
- âš ï¸ **macOS**ï¼ˆå¯ä»¥ï¼Œä½†æœªå……åˆ†æµ‹è¯•ï¼‰

### 2.3 ç½‘ç»œè¦æ±‚

**å¿…éœ€**ï¼š
- å›ºå®š IP åœ°å€ï¼ˆæ¨èï¼‰æˆ– DDNS
- å¼€æ”¾ç«¯å£ï¼š8000ï¼ˆåç«¯ APIï¼‰
- é˜²ç«å¢™é…ç½®å…è®¸å…¥ç«™è¿æ¥

**å¯é€‰**ï¼š
- 5432ï¼ˆPostgreSQLï¼Œä»…æœ¬åœ°è®¿é—®ï¼‰
- 9000ï¼ˆMinIOï¼Œå¦‚ä½¿ç”¨å¯¹è±¡å­˜å‚¨ï¼‰
- 80/443ï¼ˆNginxï¼Œå¦‚ä½¿ç”¨åå‘ä»£ç†ï¼‰

---

## 3. åç«¯éƒ¨ç½²

### 3.1 æ•°æ®åº“éƒ¨ç½²

#### å®‰è£… PostgreSQL

**Windows**ï¼š

1. ä¸‹è½½å®‰è£…ç¨‹åºï¼šhttps://www.postgresql.org/download/windows/
2. è¿è¡Œå®‰è£…ç¨‹åºï¼Œé»˜è®¤ç«¯å£ `5432`
3. è®¾ç½®è¶…çº§ç”¨æˆ·å¯†ç ï¼ˆ**è¯·è®°ä½ï¼**ï¼‰
4. å®‰è£…ç»„ä»¶ï¼šPostgreSQL Server + pgAdmin 4 + Command Line Tools

**Ubuntu**ï¼š

```bash
# æ·»åŠ  PostgreSQL å®˜æ–¹ä»“åº“
sudo apt install -y wget gnupg
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
echo "deb http://apt.postgresql.org/pub/repos/apt/ jammy-pgdg main" | sudo tee /etc/apt/sources.list.d/pgdg.list

# æ›´æ–°å¹¶å®‰è£…
sudo apt update
sudo apt install -y postgresql-18 postgresql-contrib-18

# å¯åŠ¨æœåŠ¡
sudo systemctl start postgresql
sudo systemctl enable postgresql
```

#### åˆ›å»ºæ•°æ®åº“

**Windowsï¼ˆpgAdminï¼‰**ï¼š

1. æ‰“å¼€ pgAdmin 4
2. è¿æ¥åˆ°æœ¬åœ°æœåŠ¡å™¨
3. å³é”® "Databases" â†’ "Create" â†’ "Database"
4. åç§°ï¼š`bdc_ai`

**Windowsï¼ˆå‘½ä»¤è¡Œï¼‰**ï¼š

```powershell
# æ‰“å¼€ PostgreSQL å‘½ä»¤è¡Œå·¥å…·
psql -U postgres

# åˆ›å»ºæ•°æ®åº“
CREATE DATABASE bdc_ai;

# é€€å‡º
\q
```

**Linux**ï¼š

```bash
sudo -u postgres psql

CREATE DATABASE bdc_ai;

# åˆ›å»ºä¸“ç”¨ç”¨æˆ·ï¼ˆå¯é€‰ï¼‰
CREATE USER bdc_ai WITH PASSWORD 'your-password';
GRANT ALL PRIVILEGES ON DATABASE bdc_ai TO bdc_ai;

\q
```

#### æ•°æ®åº“åˆå§‹åŒ–

```bash
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•
python scripts/init_auth_db.py
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
============================================================
BDC-AI è®¤è¯å’Œæƒé™æ•°æ®åº“åˆå§‹åŒ–
============================================================

åˆ›å»ºæ•°æ®åº“è¡¨...
âœ“ æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ
åˆå§‹åŒ–æƒé™...
âœ“ åˆ›å»ºäº† 27 ä¸ªæƒé™
åˆå§‹åŒ–è§’è‰²...
âœ“ åˆ›å»ºäº† 6 ä¸ªè§’è‰²
åˆå§‹åŒ–ç”¨æˆ·...
âœ“ åˆ›å»ºäº†é»˜è®¤ç®¡ç†å‘˜è´¦å·:
  ç”¨æˆ·å: admin
  å¯†ç : admin123
  âš  è¯·ç™»å½•åç«‹å³ä¿®æ”¹å¯†ç ï¼
```

### 3.2 MinIO éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

MinIO æ˜¯ S3 å…¼å®¹çš„å¯¹è±¡å­˜å‚¨ï¼Œç”¨äºå­˜å‚¨å›¾ç‰‡å’Œæ–‡ä»¶ã€‚

#### å®‰è£… MinIO

**Windows**ï¼š

1. ä¸‹è½½ï¼šhttps://min.io/download#/windows
2. è§£å‹åˆ° `C:\minio`
3. åˆ›å»ºæ•°æ®ç›®å½•ï¼š`C:\minio-data`

**Linux**ï¼š

```bash
# ä¸‹è½½ MinIO server
wget https://dl.min.io/server/minio/release/linux-amd64/minio
chmod +x minio
sudo mv minio /usr/local/bin/

# åˆ›å»ºæ•°æ®ç›®å½•
sudo mkdir -p /data/minio
sudo chown -R $USER:$USER /data/minio
```

#### é…ç½® MinIO

**åˆ›å»ºå¯åŠ¨è„šæœ¬**ï¼š

**Windows**ï¼š`start-minio.bat`

```batch
@echo off
set MINIO_ROOT_USER=minioadmin
set MINIO_ROOT_PASSWORD=minioadmin
minio server C:\minio-data --console-address ":9001"
```

**Linux**ï¼š`/etc/systemd/system/minio.service`

```ini
[Unit]
Description=MinIO Object Storage
After=network.target

[Service]
Type=simple
User=minio
Group=minio
Environment="MINIO_ROOT_USER=minioadmin"
Environment="MINIO_ROOT_PASSWORD=minioadmin"
ExecStart=/usr/local/bin/minio server /data/minio --console-address ":9001"
Restart=always

[Install]
WantedBy=multi-user.target
```

#### åˆ›å»º Bucket

è®¿é—® MinIO æ§åˆ¶å°ï¼šhttp://localhost:9001

1. ç™»å½•ï¼ˆé»˜è®¤ï¼šminioadmin/minioadminï¼‰
2. ç‚¹å‡» "Buckets" â†’ "Create Bucket"
3. åç§°ï¼š`bdc-assets`
4. è®¿é—®æƒé™ï¼šPublic æˆ– Private

### 3.3 åç«¯æœåŠ¡éƒ¨ç½²

#### å®‰è£… Python

**Windows**ï¼š

1. ä¸‹è½½ï¼šhttps://www.python.org/downloads/
2. å®‰è£…æ—¶å‹¾é€‰ "Add Python to PATH"
3. éªŒè¯ï¼š`python --version`

**Linux**ï¼š

```bash
# å®‰è£… Python 3.11
sudo apt install -y software-properties-common
sudo add-apt-repository ppa:deadsnakes/ppa -y
sudo apt install -y python3.11 python3.11-venv python3.11-dev

# éªŒè¯
python3.11 --version
```

#### å…‹éš†é¡¹ç›®

```bash
# Windows
mkdir D:\BDC-AI
cd D:\BDC-AI
git clone https://github.com/Jimmy-ye/buidingdatacenter-ai.git
cd buidingdatacenter-ai

# Linux
mkdir -p /opt/bdc-ai
cd /opt/bdc-ai
git clone https://github.com/Jimmy-ye/buidingdatacenter-ai.git
cd buidingdatacenter-ai
```

#### åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux
python3 -m venv venv
source venv/bin/activate
```

#### å®‰è£…ä¾èµ–

```bash
# å‡çº§ pip
pip install --upgrade pip

# å®‰è£…åç«¯ä¾èµ–
pip install -r services/backend/requirements.txt
```

#### é…ç½®ç¯å¢ƒå˜é‡

**ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆæ¨èï¼‰**ï¼š

```bash
python scripts/setup_api_keys.py
```

**æ‰‹åŠ¨é…ç½®**ï¼š

1. å¤åˆ¶é…ç½®æ¨¡æ¿ï¼š
```bash
cp .env.example .env
```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š
```bash
# æ•°æ®åº“è¿æ¥
BDC_DATABASE_URL=postgresql://postgres:password@localhost:5432/bdc_ai

# JWT å¯†é’¥ï¼ˆè¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆï¼‰
# python -c "import secrets; print(secrets.token_hex(32))"
BDC_JWT_SECRET_KEY=<ç”Ÿæˆçš„64å­—ç¬¦hex>

# GLM API KEY
GLM_API_KEY=<ä» https://open.bigmodel.cn/ è·å–>
```

### 3.4 å¯åŠ¨åç«¯æœåŠ¡

#### å¼€å‘æ¨¡å¼

```bash
# ç¡®ä¿è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»
python -m uvicorn services.backend.app.main:app --host localhost --port 8000 --reload
```

#### ç”Ÿäº§æ¨¡å¼ï¼ˆLinux systemdï¼‰

**åˆ›å»ºæœåŠ¡æ–‡ä»¶**ï¼š`/etc/systemd/system/bdc-backend.service`

```ini
[Unit]
Description=BDC-AI Backend Service
After=network.target postgresql.service
Requires=postgresql.service

[Service]
Type=simple
User=bdc_ai
Group=bdc_ai
WorkingDirectory=/opt/bdc-ai
Environment="PATH=/opt/bdc-ai/venv/bin"
EnvironmentFile=/opt/bdc-ai/.env
ExecStart=/opt/bdc-ai/venv/bin/uvicorn services.backend.app.main:app \
  --host 0.0.0.0 \
  --port 8000 \
  --workers 4 \
  --log-level info
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

**å¯åŠ¨æœåŠ¡**ï¼š

```bash
# é‡è½½ systemd
sudo systemctl daemon-reload

# å¯ç”¨å¼€æœºè‡ªå¯
sudo systemctl enable bdc-backend

# å¯åŠ¨æœåŠ¡
sudo systemctl start bdc-backend

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status bdc-backend

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u bdc-backend -f
```

#### ç”Ÿäº§æ¨¡å¼ï¼ˆWindows NSSMï¼‰

**å®‰è£… NSSM**ï¼š

1. ä¸‹è½½ï¼šhttps://nssm.cc/download
2. è§£å‹åˆ° `C:\nssm`
3. æ·»åŠ åˆ° PATH

**åˆ›å»ºæœåŠ¡**ï¼š

```powershell
# å®‰è£…æœåŠ¡
nssm install BDC-Backend "D:\BDC-AI\buidingdatacenter-ai\venv\Scripts\python.exe" "-m" "uvicorn services.backend.app.main:app" "--host 0.0.0.0" "--port 8000"

# è®¾ç½®å·¥ä½œç›®å½•
nssm set BDC-Backend AppDirectory "D:\BDC-AI\buidingdatacenter-ai"

# è®¾ç½®ç¯å¢ƒå˜é‡
nssm set BDC-Backend AppEnvironmentExtra "BDC_DATABASE_URL=postgresql://postgres:password@localhost:5432/bdc_ai"

# å¯åŠ¨æœåŠ¡
nssm start BDC-Backend

# è®¾ç½®å¼€æœºè‡ªå¯
nssm set BDC-Backend Start SERVICE_AUTO_START
```

### 3.5 åå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰

ä½¿ç”¨ Nginx ä½œä¸ºåå‘ä»£ç†ï¼Œæä¾› SSL å’Œè´Ÿè½½å‡è¡¡ã€‚

#### å®‰è£… Nginx

**Ubuntu**ï¼š

```bash
sudo apt install -y nginx
```

**Windows**ï¼š

1. ä¸‹è½½ï¼šhttp://nginx.org/en/download.html
2. è§£å‹åˆ° `C:\nginx`

#### é…ç½® Nginx

**åˆ›å»ºé…ç½®æ–‡ä»¶**ï¼š`/etc/nginx/sites-available/bdc-ai`ï¼ˆUbuntuï¼‰

```nginx
server {
    listen 80;
    server_name your-domain.com;

    # é‡å®šå‘åˆ° HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com;

    # SSL è¯ä¹¦
    ssl_certificate /etc/nginx/ssl/bdc-ai.crt;
    ssl_certificate_key /etc/nginx/ssl/bdc-ai.key;

    # SSL é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_prefer_server_ciphers on;

    # ä»£ç†åˆ° FastAPI
    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket æ”¯æŒ
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }

    # æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶
    client_max_body_size 100M;
}
```

**å¯ç”¨é…ç½®**ï¼š

```bash
# åˆ›å»ºç¬¦å·é“¾æ¥
sudo ln -s /etc/nginx/sites-available/bdc-ai /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯ Nginx
sudo systemctl restart nginx
```

---

## 4. ç§»åŠ¨ç«¯éƒ¨ç½²

### 4.1 Android éƒ¨ç½²

#### æ„å»º APK

**å‰ææ¡ä»¶**ï¼š
- å®‰è£… Flutter SDKï¼šhttps://flutter.dev/docs/get-started/install
- å®‰è£… Android Studio

**æ„å»ºæ­¥éª¤**ï¼š

```bash
# è¿›å…¥ç§»åŠ¨ç«¯ç›®å½•
cd services/mobile

# è·å–ä¾èµ–
flutter pub get

# ç”Ÿæˆ APKï¼ˆdebug ç‰ˆæœ¬ï¼‰
flutter build apk --debug

# ç”Ÿæˆ APKï¼ˆrelease ç‰ˆæœ¬ï¼‰
flutter build apk --release
```

**APK ä½ç½®**ï¼š
- Debug: `build/app/outputs/flutter-apk/app-debug.apk`
- Release: `build/app/outputs/flutter-apk/app-release.apk`

#### ç­¾åé…ç½®

**åˆ›å»ºå¯†é’¥åº“**ï¼š

```bash
keytool -genkey -v -keystore ~/bdc-ai-key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias bdc-ai
```

**é…ç½®ç­¾å**ï¼š`android/key.properties`

```properties
storePassword=your-password
keyPassword=your-password
keyAlias=bdc-ai
storeFile=/path/to/bdc-ai-key.jks
```

**æ„å»ºç­¾åçš„ APK**ï¼š

```bash
flutter build apk --release
```

#### å‘å¸ƒåˆ°åº”ç”¨å•†åº—

1. åˆ›å»º Google Play å¼€å‘è€…è´¦å·
2. åˆ›å»ºåº”ç”¨åˆ—è¡¨
3. ä¸Šä¼  APK
4. å¡«å†™å•†åº—ä¿¡æ¯
5. æäº¤å®¡æ ¸

### 4.2 iOS éƒ¨ç½²

#### æ„å»º IPA

**å‰ææ¡ä»¶**ï¼š
- macOS è®¡ç®—æœº
- Xcode
- Apple å¼€å‘è€…è´¦å·

**æ„å»ºæ­¥éª¤**ï¼š

```bash
# è¿›å…¥ç§»åŠ¨ç«¯ç›®å½•
cd services/mobile

# è·å–ä¾èµ–
flutter pub get

# æ„å»º IPA
flutter build ios --release
```

#### å‘å¸ƒåˆ° App Store

1. æ‰“å¼€ Xcodeï¼š`open ios/Runner.xcworkspace`
2. é€‰æ‹© "Generic iOS Device"
3. Product â†’ Archive
4. åœ¨ Organizer ä¸­åˆ†å‘ç»™ App Store

---

## 5. PC-UI éƒ¨ç½²

### 5.1 æœåŠ¡éƒ¨ç½²

PC-UI ä½¿ç”¨ NiceGUIï¼Œä¸åç«¯æœåŠ¡éƒ¨ç½²åœ¨åŒä¸€æœåŠ¡å™¨ã€‚

#### å®‰è£…ä¾èµ–

```bash
# PC-UI ä¾èµ–å·²åœ¨åç«¯ requirements.txt ä¸­
pip install nicegui
```

#### é…ç½®ç¯å¢ƒ

ç¼–è¾‘ `services/pc-ui/.env`ï¼š

```bash
BDC_BACKEND_BASE_URL=http://localhost:8000
PC_UI_PORT=8080
```

#### å¯åŠ¨æœåŠ¡

**å¼€å‘æ¨¡å¼**ï¼š

```bash
cd services/pc-ui
python -m nicegui main:app --port 8080
```

**ç”Ÿäº§æ¨¡å¼ï¼ˆLinux systemdï¼‰**ï¼š

åˆ›å»º `/etc/systemd/system/bdc-pcui.service`ï¼š

```ini
[Unit]
Description=BDC-AI PC-UI Service
After=network.target bdc-backend.service
Requires=bdc-backend.service

[Service]
Type=simple
User=bdc_ai
WorkingDirectory=/opt/bdc-ai/services/pc-ui
Environment="PATH=/opt/bdc-ai/venv/bin"
EnvironmentFile=/opt/bdc-ai/services/pc-ui/.env
ExecStart=/opt/bdc-ai/venv/bin/python -m nicegui main:app --port 8080
Restart=always

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š

```bash
sudo systemctl enable bdc-pcui
sudo systemctl start bdc-pcui
sudo systemctl status bdc-pcui
```

### 5.2 è®¿é—®é…ç½®

è®¿é—® PC-UIï¼šhttp://your-server:8080

**åå‘ä»£ç†é…ç½®**ï¼ˆNginxï¼‰ï¼š

```nginx
location /pc-ui/ {
    proxy_pass http://127.0.0.1:8080/;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

    # WebSocket æ”¯æŒ
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
}
```

---

## 6. ç›‘æ§å’Œæ—¥å¿—

### 6.1 æ—¥å¿—ç®¡ç†

#### æ—¥å¿—é…ç½®

**FastAPI æ—¥å¿—**ï¼š

```python
# services/backend/app/main.py
import logging

logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('logs/bdc-backend.log'),
        logging.StreamHandler()
    ]
)
```

#### æ—¥å¿—ä½ç½®

| æœåŠ¡ | æ—¥å¿—ä½ç½® |
|-----|---------|
| åç«¯ (å¼€å‘) | æ§åˆ¶å°è¾“å‡º |
| åç«¯ (systemd) | `sudo journalctl -u bdc-backend -f` |
| PC-UI (systemd) | `sudo journalctl -u bdc-pcui -f` |
| PostgreSQL | `/var/log/postgresql/` |
| Nginx | `/var/log/nginx/` |

#### æ—¥å¿—è½®è½¬

**åˆ›å»º logrotate é…ç½®**ï¼š`/etc/logrotate.d/bdc-ai`

```
/opt/bdc-ai/logs/*.log {
    daily
    rotate 14
    compress
    delaycompress
    missingok
    notifempty
    create 0640 bdc_ai bdc_ai
    sharedscripts
    postrotate
        systemctl reload bdc-backend > /dev/null 2>&1 || true
    endscript
}
```

### 6.2 æ€§èƒ½ç›‘æ§

#### æ•°æ®åº“ç›‘æ§

**æŸ¥è¯¢æ•°æ®åº“è¿æ¥æ•°**ï¼š

```sql
SELECT count(*) FROM pg_stat_activity;
```

**æŸ¥è¯¢æ…¢æŸ¥è¯¢**ï¼š

```sql
SELECT query, calls, total_time, mean_time
FROM pg_stat_statements
ORDER BY mean_time DESC
LIMIT 10;
```

#### æœåŠ¡ç›‘æ§

**å¥åº·æ£€æŸ¥è„šæœ¬**ï¼š`scripts/health_check.sh`

```bash
#!/bin/bash
# å¥åº·æ£€æŸ¥è„šæœ¬

HEALTH_URL="http://localhost:8000/api/v1/health"
RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" $HEALTH_URL)

if [ $RESPONSE -eq 200 ]; then
    echo "âœ“ Service is healthy"
    exit 0
else
    echo "âœ— Service is unhealthy (HTTP $RESPONSE)"
    # å‘é€å‘Šè­¦é€šçŸ¥
    # curl -X POST https://hooks.slack.com/... -d '{"text":"BDC-AI Service Down!"}'
    exit 1
fi
```

**å®šæ—¶æ£€æŸ¥**ï¼š

```bash
# æ·»åŠ åˆ° crontab
crontab -e

# æ¯ 5 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡
*/5 * * * * /opt/bdc-ai/scripts/health_check.sh >> /var/log/bdc-health.log 2>&1
```

### 6.3 å‘Šè­¦é…ç½®

#### ä½¿ç”¨ Prometheus + Grafanaï¼ˆå¯é€‰ï¼‰

**å®‰è£… Prometheus**ï¼š

```bash
sudo apt install -y prometheus
sudo systemctl enable prometheus
sudo systemctl start prometheus
```

**é…ç½® Prometheus**ï¼š`/etc/prometheus/prometheus.yml`

```yaml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'bdc-backend'
    static_configs:
      - targets: ['localhost:8000']
    metrics_path: '/metrics'
```

**å®‰è£… Grafana**ï¼š

```bash
sudo apt install -y grafana
sudo systemctl enable grafana-server
sudo systemctl start grafana-server
```

è®¿é—® Grafanaï¼šhttp://localhost:3000ï¼ˆé»˜è®¤ admin/adminï¼‰

---

## 7. å¤‡ä»½å’Œæ¢å¤

### 7.1 æ•°æ®å¤‡ä»½

#### æ•°æ®åº“å¤‡ä»½

**å¤‡ä»½è„šæœ¬**ï¼š`scripts/backup_database.sh`

```bash
#!/bin/bash
# æ•°æ®åº“å¤‡ä»½è„šæœ¬

BACKUP_DIR="/backup/postgres"
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="$BACKUP_DIR/bdc_ai_$DATE.sql.gz"

mkdir -p $BACKUP_DIR

# å¤‡ä»½æ•°æ®åº“
PGPASSWORD=your-password pg_dump -U postgres bdc_ai | gzip > $BACKUP_FILE

echo "Backup completed: $BACKUP_FILE"

# ä¿ç•™æœ€è¿‘ 30 å¤©çš„å¤‡ä»½
find $BACKUP_DIR -name "bdc_ai_*.sql.gz" -mtime +30 -delete
```

**å®šæ—¶å¤‡ä»½**ï¼š

```bash
# ç¼–è¾‘ crontab
crontab -e

# æ¯å¤©å‡Œæ™¨ 2 ç‚¹å¤‡ä»½
0 2 * * * /opt/bdc-ai/scripts/backup_database.sh >> /var/log/db_backup.log 2>&1
```

#### æ–‡ä»¶å¤‡ä»½

**å¤‡ä»½ MinIO æ•°æ®**ï¼š

```bash
#!/bin/bash
# MinIO å¤‡ä»½è„šæœ¬

BACKUP_DIR="/backup/minio"
DATE=$(date +%Y%m%d_%H%M%S)
SOURCE_DIR="/data/minio"

rsync -av --delete $SOURCE_DIR $BACKUP_DIR/minio_$DATE/

echo "MinIO backup completed: $BACKUP_DIR/minio_$DATE/"
```

#### é…ç½®å¤‡ä»½

```bash
#!/bin/bash
# é…ç½®å¤‡ä»½è„šæœ¬

BACKUP_DIR="/backup/config"
DATE=$(date +%Y%m%d_%H%M%S)

# å¤‡ä»½ç¯å¢ƒå˜é‡
cp /opt/bdc-ai/.env $BACKUP_DIR/.env.$DATE

# å¤‡ä»½ Nginx é…ç½®
cp -r /etc/nginx $BACKUP_DIR/nginx_$DATE/

echo "Config backup completed: $BACKUP_DIR/"
```

### 7.2 ç¾éš¾æ¢å¤

#### æ•°æ®åº“æ¢å¤

```bash
# è§£å‹å¤‡ä»½æ–‡ä»¶
gunzip /backup/postgres/bdc_ai_20260125_020000.sql.gz

# æ¢å¤æ•°æ®åº“
psql -U postgres -d bdc_ai < /backup/postgres/bdc_ai_20260125_020000.sql
```

#### å®Œæ•´æ¢å¤æµç¨‹

1. **æ¢å¤æ“ä½œç³»ç»Ÿ**ï¼ˆå¦‚éœ€è¦ï¼‰
2. **å®‰è£…ä¾èµ–**ï¼šPython, PostgreSQL, Nginx
3. **æ¢å¤é…ç½®æ–‡ä»¶**ï¼š`.env`, Nginx é…ç½®
4. **æ¢å¤æ•°æ®åº“**ï¼šå¯¼å…¥ SQL å¤‡ä»½
5. **æ¢å¤æ–‡ä»¶**ï¼šMinIO æ•°æ®
6. **å¯åŠ¨æœåŠ¡**ï¼šsystemd services
7. **éªŒè¯ç³»ç»Ÿ**ï¼šå¥åº·æ£€æŸ¥

---

## 8. å®‰å…¨åŠ å›º

### 8.1 ç½‘ç»œå®‰å…¨

#### é˜²ç«å¢™é…ç½®

**Ubuntu (UFW)**ï¼š

```bash
# å¯ç”¨é˜²ç«å¢™
sudo ufw enable

# å…è®¸ SSH
sudo ufw allow 22/tcp

# å…è®¸ HTTP/HTTPS
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp

# å…è®¸åç«¯ APIï¼ˆå¯é€‰ï¼Œå¦‚æœé€šè¿‡ Nginx ä»£ç†åˆ™ä¸éœ€è¦ï¼‰
sudo ufw allow 8000/tcp

# æ‹’ç»æ•°æ®åº“å¤–éƒ¨è®¿é—®
sudo ufw deny 5432/tcp

# æŸ¥çœ‹çŠ¶æ€
sudo ufw status
```

**Windows é˜²ç«å¢™**ï¼š

```powershell
# å…è®¸ç«¯å£ 8000
New-NetFirewallRule -DisplayName "BDC-AI Backend" -Direction Inbound -LocalPort 8000 -Protocol TCP -Action Allow
```

### 8.2 SSL/TLS é…ç½®

#### è·å– Let's Encrypt è¯ä¹¦

**å®‰è£… Certbot**ï¼š

```bash
sudo apt install -y certbot python3-certbot-nginx
```

**è·å–è¯ä¹¦**ï¼š

```bash
sudo certbot --nginx -d your-domain.com
```

**è‡ªåŠ¨ç»­æœŸ**ï¼š

```bash
# æµ‹è¯•ç»­æœŸ
sudo certbot renew --dry-run

# Certbot ä¼šè‡ªåŠ¨æ·»åŠ  cron ä»»åŠ¡
```

### 8.3 åº”ç”¨å®‰å…¨

#### å¯†é’¥ç®¡ç†

**ç”Ÿæˆå®‰å…¨çš„ JWT å¯†é’¥**ï¼š

```bash
python -c "import secrets; print(secrets.token_hex(32))"
```

**å®šæœŸè½®æ¢å¯†é’¥**ï¼ˆå»ºè®®æ¯ 90 å¤©ï¼‰ï¼š

```bash
# ç”Ÿæˆæ–°å¯†é’¥
NEW_KEY=$(python -c "import secrets; print(secrets.token_hex(32))")

# æ›´æ–° .env
sed -i "s/BDC_JWT_SECRET_KEY=.*/BDC_JWT_SECRET_KEY=$NEW_KEY/" .env

# é‡å¯æœåŠ¡
sudo systemctl restart bdc-backend
```

#### æƒé™æ§åˆ¶

**ä¿®æ”¹é»˜è®¤å¯†ç **ï¼š

```bash
curl -X POST http://localhost:8000/api/v1/auth/me/change-password \
  -H "Authorization: Bearer <admin_token>" \
  -H "Content-Type: application/json" \
  -d '{"old_password":"admin123","new_password":"NewSecurePass456!"}'
```

**åˆ›å»ºæœ€å°æƒé™ç”¨æˆ·**ï¼š

```bash
# åªè¯»ç”¨æˆ·
curl -X POST http://localhost:8000/api/v1/auth/users/ \
  -H "Authorization: Bearer <admin_token>" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "viewer1",
    "email": "viewer1@example.com",
    "password": "Viewer123!",
    "role": "viewer"
  }'
```

### 8.4 å®¡è®¡æ—¥å¿—

**æŸ¥çœ‹å®¡è®¡æ—¥å¿—**ï¼š

```sql
-- æŸ¥è¯¢æœ€è¿‘ 7 å¤©çš„å®¡è®¡æ—¥å¿—
SELECT * FROM audit_logs
WHERE created_at >= NOW() - INTERVAL '7 days'
ORDER BY created_at DESC;
```

**å¯¼å‡ºå®¡è®¡æ—¥å¿—**ï¼š

```bash
psql -U postgres -d bdc_ai -c "COPY audit_logs TO '/tmp/audit_logs.csv' CSV HEADER;"
```

---

## 9. è¿ç»´æ“ä½œ

### 9.1 æ—¥å¸¸è¿ç»´

#### æœåŠ¡å¯åœ

**Linux**ï¼š

```bash
# å¯åŠ¨
sudo systemctl start bdc-backend

# åœæ­¢
sudo systemctl stop bdc-backend

# é‡å¯
sudo systemctl restart bdc-backend

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status bdc-backend

# é‡æ–°åŠ è½½é…ç½®
sudo systemctl reload bdc-backend
```

**Windows**ï¼š

```powershell
# å¯åŠ¨
nssm start BDC-Backend

# åœæ­¢
nssm stop BDC-Backend

# é‡å¯
nssm restart BDC-Backend

# æŸ¥çœ‹çŠ¶æ€
nssm status BDC-Backend
```

#### æ—¥å¿—æŸ¥çœ‹

**Linux**ï¼š

```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u bdc-backend -f

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œ
sudo journalctl -u bdc-backend -n 100

# æŸ¥çœ‹ä»Šå¤©æ—¥å¿—
sudo journalctl -u bdc-backend --since today
```

**Windows**ï¼š

```powershell
# æŸ¥çœ‹ NSSM æœåŠ¡æ—¥å¿—
nssm edit BDC-Backend
```

#### æ€§èƒ½è°ƒä¼˜

**æ•°æ®åº“ä¼˜åŒ–**ï¼š

```sql
-- VACUUM å’Œ ANALYZE
VACUUM ANALYZE;

-- é‡å»ºç´¢å¼•
REINDEX DATABASE bdc_ai;
```

**PostgreSQL é…ç½®**ï¼š`/etc/postgresql/18/main/postgresql.conf`

```ini
# è¿æ¥æ•°
max_connections = 100

# å†…å­˜é…ç½®
shared_buffers = 256MB
effective_cache_size = 1GB
work_mem = 16MB

# æŸ¥è¯¢ä¼˜åŒ–
random_page_cost = 1.1
```

### 9.2 æ›´æ–°éƒ¨ç½²

#### ä»£ç æ›´æ–°

```bash
# å¤‡ä»½å½“å‰ç‰ˆæœ¬
cp -r /opt/bdc-ai /backup/bdc-ai-$(date +%Y%m%d)

# æ‹‰å–æœ€æ–°ä»£ç 
git pull origin master

# å®‰è£…æ–°ä¾èµ–
pip install -r services/backend/requirements.txt

# é‡å¯æœåŠ¡
sudo systemctl restart bdc-backend

# éªŒè¯æœåŠ¡
curl http://localhost:8000/api/v1/health
```

#### æ•°æ®åº“è¿ç§»

```bash
# è¿è¡Œè¿ç§»è„šæœ¬ï¼ˆå¦‚æœæœ‰ï¼‰
python scripts/migrate_db.py

# æˆ–ä½¿ç”¨ Alembicï¼ˆå¦‚æœé…ç½®ï¼‰
alembic upgrade head
```

#### å›æ»šæ“ä½œ

```bash
# åœæ­¢æœåŠ¡
sudo systemctl stop bdc-backend

# æ¢å¤ä»£ç 
rm -rf /opt/bdc-ai
cp -r /backup/bdc-ai-20260125 /opt/bdc-ai

# æ¢å¤ä¾èµ–
cd /opt/bdc-ai
pip install -r services/backend/requirements.txt

# å¯åŠ¨æœåŠ¡
sudo systemctl start bdc-backend

# éªŒè¯
curl http://localhost:8000/api/v1/health
```

---

## 10. æ•…éšœæ’æŸ¥

### 10.1 å¸¸è§é—®é¢˜

#### æœåŠ¡å¯åŠ¨å¤±è´¥

**ç—‡çŠ¶**ï¼š`systemctl start bdc-backend` å¤±è´¥

**æ’æŸ¥æ­¥éª¤**ï¼š

1. æŸ¥çœ‹è¯¦ç»†é”™è¯¯ï¼š
```bash
sudo journalctl -u bdc-backend -n 50 --no-pager
```

2. æ£€æŸ¥é…ç½®æ–‡ä»¶ï¼š
```bash
cat /etc/systemd/system/bdc-backend.service
```

3. éªŒè¯ç¯å¢ƒå˜é‡ï¼š
```bash
cat /opt/bdc-ai/.env
```

4. æµ‹è¯•æ‰‹åŠ¨å¯åŠ¨ï¼š
```bash
cd /opt/bdc-ai
source venv/bin/activate
python -m uvicorn services.backend.app.main:app --host localhost --port 8000
```

#### æ•°æ®åº“è¿æ¥å¤±è´¥

**ç—‡çŠ¶**ï¼š`connection refused` æˆ– `could not connect to server`

**æ’æŸ¥æ­¥éª¤**ï¼š

1. æ£€æŸ¥ PostgreSQL çŠ¶æ€ï¼š
```bash
sudo systemctl status postgresql
```

2. æµ‹è¯•æ•°æ®åº“è¿æ¥ï¼š
```bash
psql -U postgres -d bdc_ai -c "SELECT 1;"
```

3. æ£€æŸ¥æ•°æ®åº“ URLï¼š
```bash
cat .env | grep DATABASE_URL
```

4. æ£€æŸ¥é˜²ç«å¢™ï¼š
```bash
sudo ufw status
```

#### æ€§èƒ½é—®é¢˜

**ç—‡çŠ¶**ï¼šAPI å“åº”ç¼“æ…¢

**æ’æŸ¥æ­¥éª¤**ï¼š

1. æŸ¥çœ‹æ•°æ®åº“è¿æ¥æ•°ï¼š
```sql
SELECT count(*) FROM pg_stat_activity;
```

2. æŸ¥çœ‹æ…¢æŸ¥è¯¢ï¼š
```sql
SELECT query, calls, total_time, mean_time
FROM pg_stat_statements
ORDER BY mean_time DESC
LIMIT 10;
```

3. æŸ¥çœ‹ç³»ç»Ÿèµ„æºï¼š
```bash
top
htop
df -h
```

4. æŸ¥çœ‹åº”ç”¨æ—¥å¿—ï¼š
```bash
sudo journalctl -u bdc-backend -f
```

### 10.2 è¯Šæ–­å·¥å…·

#### æ•°æ®åº“è¯Šæ–­

```sql
-- è¡¨å¤§å°
SELECT
  schemaname,
  tablename,
  pg_size_pretty(pg_total_relation_size(schemaname||'.'||tablename)) AS size
FROM pg_tables
WHERE schemaname = 'public'
ORDER BY pg_total_relation_size(schemaname||'.'||tablename) DESC;

-- ç´¢å¼•ä½¿ç”¨æƒ…å†µ
SELECT
  schemaname,
  tablename,
  indexname,
  idx_scan,
  idx_tup_read,
  idx_tup_fetch
FROM pg_stat_user_indexes
ORDER BY idx_scan ASC;

-- æ´»è·ƒæŸ¥è¯¢
SELECT
  pid,
  now() - pg_stat_activity.query_start AS duration,
  query,
  state
FROM pg_stat_activity
WHERE (now() - pg_stat_activity.query_start) > interval '5 minutes';
```

#### ç³»ç»Ÿè¯Šæ–­

```bash
# CPU ä½¿ç”¨ç‡
top -bn1 | grep "Cpu(s)"

# å†…å­˜ä½¿ç”¨
free -h

# ç£ç›˜ä½¿ç”¨
df -h

# ç½‘ç»œè¿æ¥
netstat -tunlp

# ç«¯å£å ç”¨
sudo lsof -i :8000
```

---

## 11. æœ€ä½³å®è·µ

### 11.1 è‡ªåŠ¨åŒ–è¿ç»´

#### ä½¿ç”¨ Ansibleï¼ˆæ¨èï¼‰

**å®‰è£… Ansible**ï¼š

```bash
sudo apt install -y ansible
```

**Playbook ç¤ºä¾‹**ï¼š`deploy.yml`

```yaml
---
- name: Deploy BDC-AI
  hosts: bdc_servers
  become: yes

  tasks:
    - name: Update apt cache
      apt:
        update_cache: yes

    - name: Install dependencies
      apt:
        name:
          - python3.11
          - postgresql-18
          - nginx
        state: present

    - name: Copy project files
      synchronize:
        src: ./buidingdatacenter-ai/
        dest: /opt/bdc-ai/
        delete: yes

    - name: Install Python dependencies
      pip:
        requirements: /opt/bdc-ai/services/backend/requirements.txt
        virtualenv: /opt/bdc-ai/venv

    - name: Start backend service
      systemd:
        name: bdc-backend
        state: restarted
        enabled: yes
```

**è¿è¡Œ Playbook**ï¼š

```bash
ansible-playbook -i inventory deploy.yml
```

### 11.2 å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

#### Docker Compose é…ç½®

**docker-compose.yml**ï¼š

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:18
    environment:
      POSTGRES_DB: bdc_ai
      POSTGRES_USER: bdc_ai
      POSTGRES_PASSWORD: ${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  backend:
    build: .
    depends_on:
      - postgres
    environment:
      BDC_DATABASE_URL: postgresql://bdc_ai:${DB_PASSWORD}@postgres:5432/bdc_ai
      BDC_JWT_SECRET_KEY: ${JWT_SECRET}
    ports:
      - "8000:8000"
    volumes:
      - ./data:/app/data

  nginx:
    image: nginx:latest
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/nginx/ssl

volumes:
  postgres_data:
```

**å¯åŠ¨æœåŠ¡**ï¼š

```bash
docker-compose up -d
```

### 11.3 ç›‘æ§å‘Šè­¦

#### ä½¿ç”¨ Prometheus + Grafana

å‚è€ƒç¬¬ 6.3 èŠ‚çš„é…ç½®ã€‚

#### ä½¿ç”¨ Slack å‘Šè­¦

**å‘Šè­¦è„šæœ¬**ï¼š`scripts/alert.sh`

```bash
#!/bin/bash
# å‘é€ Slack å‘Šè­¦

WEBHOOK_URL="https://hooks.slack.com/services/YOUR/WEBHOOK/URL"
MESSAGE="BDC-AI æœåŠ¡å‘Šè­¦: $1"

curl -X POST $WEBHOOK_URL \
  -H 'Content-Type: application/json' \
  -d "{\"text\": \"$MESSAGE\"}"
```

**ä½¿ç”¨**ï¼š

```bash
./scripts/alert.sh "æ•°æ®åº“è¿æ¥å¤±è´¥"
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **[åç«¯APIå¼€å‘æŒ‡å—.md](./åç«¯APIå¼€å‘æŒ‡å—.md)** - API å¼€å‘å®Œæ•´æŒ‡å—
- **[è´¦å·æƒé™ç³»ç»Ÿä½¿ç”¨æŒ‡å—.md](./è´¦å·æƒé™ç³»ç»Ÿä½¿ç”¨æŒ‡å—.md)** - è®¤è¯ç³»ç»ŸæŒ‡å—
- **[docs/02-æŠ€æœ¯æ–‡æ¡£/backend/åç«¯æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æŒ‡å—.md](../02-æŠ€æœ¯æ–‡æ¡£/backend/åç«¯æœåŠ¡å™¨éƒ¨ç½²å®Œæ•´æŒ‡å—.md)** - è¯¦ç»†éƒ¨ç½²æ­¥éª¤
- **[docs/02-æŠ€æœ¯æ–‡æ¡£/API-KEYå®‰å…¨ç®¡ç†æ–¹æ¡ˆ.md](../02-æŠ€æœ¯æ–‡æ¡£/backend/API-KEYå®‰å…¨ç®¡ç†æ–¹æ¡ˆ.md)** - API å¯†é’¥ç®¡ç†

---

## ğŸ”— å¿«é€Ÿé“¾æ¥

- **PostgreSQL æ–‡æ¡£**: https://www.postgresql.org/docs/
- **FastAPI æ–‡æ¡£**: https://fastapi.tiangolo.com/
- **Nginx æ–‡æ¡£**: https://nginx.org/en/docs/
- **MinIO æ–‡æ¡£**: https://min.io/docs/

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**æœ€åæ›´æ–°**: 2026-01-25
**ç»´æŠ¤è€…**: BDC-AI å¼€å‘å›¢é˜Ÿ
**çŠ¶æ€**: âœ… å·²å®Œæˆ
